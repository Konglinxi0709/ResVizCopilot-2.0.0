# ResVizCopilot 2.0 å‰ç«¯æ€»ä½“éœ€æ±‚å’Œæ¶æ„è®¾è®¡

## å‚è€ƒæ–‡ä»¶è¯´æ˜

æœ¬è®¾è®¡æ–‡æ¡£åŸºäºä»¥ä¸‹å‚è€ƒæ–‡ä»¶å’Œèµ„æºè¿›è¡Œè®¾è®¡ï¼š

### éœ€æ±‚å’Œè§„åˆ’æ–‡ä»¶
- **`frontend/å‰ç«¯è®¾è®¡è‰ç¨¿.md`**ï¼šç”¨æˆ·æä¾›çš„å‰ç«¯éœ€æ±‚è‰ç¨¿ï¼Œæ˜ç¡®äº†ä¸‰å¤§åŠŸèƒ½æ¨¡å—ï¼ˆå·¥ç¨‹å­˜æ¡£ç®¡ç†ã€ç ”ç©¶æ ‘å¯è§†åŒ–ã€æ¶ˆæ¯åˆ—è¡¨å’ŒAIå¯¹è¯ï¼‰çš„åŸºæœ¬éœ€æ±‚å’Œçº¦æŸæ¡ä»¶
- **`README.md`**ï¼šé¡¹ç›®æ•´ä½“ä»‹ç»æ–‡æ¡£ï¼Œæä¾›äº†ç³»ç»Ÿæ¶æ„ã€æ ¸å¿ƒåŠŸèƒ½ã€æŠ€æœ¯æ ˆé€‰æ‹©å’ŒAPIæ¥å£è®¾è®¡çš„æ€»ä½“æ¡†æ¶
- **`openaiapi.json`**ï¼šåç«¯æ¥å£æ•°æ®è¯¦ç»†è¯´æ˜

### åç«¯å‚è€ƒ
- **`backend/` ç›®å½•**ï¼šåç«¯å®ç°ä»£ç ï¼Œç‰¹åˆ«æ˜¯æ•°æ®æ¨¡å‹å®šä¹‰å’ŒAPIæ¥å£å®ç°ï¼Œä¸ºå‰ç«¯æ•°æ®ç»“æ„è®¾è®¡å’Œæ¥å£å¯¹æ¥æä¾›ä¾æ®
- **`backend/data/projects/æµ‹è¯•1.json`**ï¼šå®é™…çš„ç ”ç©¶æ ‘æ•°æ®ç¤ºä¾‹ï¼Œå±•ç¤ºäº†åç«¯æ•°æ®çš„å®Œæ•´ç»“æ„ï¼ŒåŒ…æ‹¬é—®é¢˜èŠ‚ç‚¹ã€è§£å†³æ–¹æ¡ˆèŠ‚ç‚¹çš„å±‚æ¬¡å…³ç³»å’Œå±æ€§å®šä¹‰
- **`test_CLI_frontend.py`**ï¼šå‘½ä»¤è¡Œå‰ç«¯æµ‹è¯•ç¨‹åºï¼Œå±•ç¤ºäº†å‰ç«¯ä¸šåŠ¡é€»è¾‘çš„å®Œæ•´å®ç°ï¼ŒåŒ…æ‹¬æ¶ˆæ¯å¤„ç†ã€å·¥ç¨‹ç®¡ç†ã€æ™ºèƒ½ä½“äº¤äº’ç­‰æ ¸å¿ƒåŠŸèƒ½æµç¨‹

### è€é¡¹ç›®å‚è€ƒ
- **`tests/frontendï¼ˆè€ï¼‰/src/App/MindTree.vue`**ï¼šè€ç‰ˆæœ¬çš„æ€ç»´å¯¼å›¾ç»„ä»¶å®ç°ï¼Œå±•ç¤ºäº†Mind-elixirçš„é›†æˆæ–¹å¼ã€èŠ‚ç‚¹æ ·å¼æ§åˆ¶ã€äº‹ä»¶å¤„ç†å’Œæ•°æ®åŒæ­¥æœºåˆ¶
- **`tests/frontendï¼ˆè€ï¼‰/src/App/ChatBox.vue`**ï¼šè€ç‰ˆæœ¬çš„èŠå¤©ç»„ä»¶ï¼Œæä¾›äº†æ¶ˆæ¯åˆ—è¡¨å±•ç¤ºã€ç”¨æˆ·äº¤äº’å’ŒUIè®¾è®¡çš„å‚è€ƒ
- **`tests/frontendï¼ˆè€ï¼‰/src/App/` å…¶ä»–ç»„ä»¶**ï¼šåŒ…æ‹¬AppHeader.vueã€ProblemInfo.vueã€ChatInput.vueã€ChatMessage.vueã€MarkdownRenderer.vueç­‰ï¼Œä¸ºæ–°ç‰ˆæœ¬ç»„ä»¶è®¾è®¡æä¾›UIå’Œäº¤äº’æ¨¡å¼å‚è€ƒ

### Mind-elixiræŠ€æœ¯å‚è€ƒ
- **`frontend/mind-elixirä»‹ç»æ–‡æ¡£.md`**ï¼šMind-elixirå®˜æ–¹æ–‡æ¡£ï¼Œè¯¦ç»†ä»‹ç»äº†æ€ç»´å¯¼å›¾åº“çš„åŠŸèƒ½ç‰¹æ€§ã€APIæ¥å£ã€é…ç½®é€‰é¡¹å’Œä½¿ç”¨æ–¹æ³•
- **`tests/node-menuï¼ˆmind-elixirçš„æ’ä»¶ï¼Œç”¨äºå‚è€ƒï¼‰/`**ï¼šMind-elixirå®˜æ–¹æ’ä»¶ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•æ‰©å±•æ€ç»´å¯¼å›¾åŠŸèƒ½ã€è‡ªå®šä¹‰èŠ‚ç‚¹æ ·å¼å’Œå®ç°æ’ä»¶æœºåˆ¶
- **`tests/frontendï¼ˆè€ï¼‰/node_modules/mind-elixir/dist/types/index.d.ts`**ï¼šMind-elixirçš„ç±»å‹å®šä¹‰æ–‡ä»¶ï¼Œæä¾›äº†å®Œæ•´çš„APIæ¥å£è¯´æ˜å’Œæ•°æ®ç»“æ„å®šä¹‰

### å‚è€ƒä»·å€¼æ€»ç»“
- **éœ€æ±‚æ˜ç¡®**ï¼šé€šè¿‡è®¾è®¡è‰ç¨¿å’ŒREADMEæ˜ç¡®åŠŸèƒ½è¾¹ç•Œå’ŒæŠ€æœ¯è¦æ±‚
- **æ•°æ®ç»“æ„æ¸…æ™°**ï¼šé€šè¿‡åç«¯ä»£ç å’Œæµ‹è¯•æ•°æ®äº†è§£å®Œæ•´çš„æ•°æ®æ¨¡å‹
- **å®ç°è·¯å¾„å¯è¡Œ**ï¼šé€šè¿‡è€é¡¹ç›®ä»£ç éªŒè¯æŠ€æœ¯æ–¹æ¡ˆçš„å¯è¡Œæ€§
- **æŠ€æœ¯é€‰å‹åˆç†**ï¼šé€šè¿‡Mind-elixiræ–‡æ¡£å’Œæ’ä»¶ç¤ºä¾‹ç¡®ä¿æŠ€æœ¯å®ç°çš„æœ€ä½³å®è·µ

## é¡¹ç›®æ¦‚è¿°

ResVizCopilot 2.0 æ˜¯ä¸€ä¸ªåŸºäºå¤§æ¨¡å‹çš„ç§‘ç ”æ™ºèƒ½ä½“é¡¹ç›®ï¼Œå‰ç«¯é‡‡ç”¨ Vue 3 + Element Plus æŠ€æœ¯æ ˆï¼Œå®ç°ç ”ç©¶æ ‘å¯è§†åŒ–ç®¡ç†ã€æ™ºèƒ½ä½“æµå¼å¯¹è¯å’Œå·¥ç¨‹å­˜æ¡£ç®¡ç†ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **ç ”ç©¶æ ‘å¯è§†åŒ–**ï¼šåŸºäº Mind-elixir çš„äº¤äº’å¼æ€ç»´å¯¼å›¾ï¼Œæ”¯æŒé—®é¢˜-è§£å†³æ–¹æ¡ˆå±‚çº§ç»“æ„
- **æ™ºèƒ½ä½“æµå¼å¯¹è¯**ï¼šåŸºäº SSE çš„å®æ—¶æµå¼äº¤äº’ï¼Œæ”¯æŒå¤šæ™ºèƒ½ä½“åä½œ
- **å·¥ç¨‹å­˜æ¡£ç®¡ç†**ï¼šå®Œæ•´çš„é¡¹ç›®ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œæ”¯æŒç‰ˆæœ¬æ§åˆ¶å’Œå†å²å›æº¯
- **å“åº”å¼è®¾è®¡**ï¼šæ”¯æŒæ¡Œé¢ã€å¹³æ¿ã€ç§»åŠ¨ç«¯çš„è‡ªé€‚åº”å¸ƒå±€
- **å›½é™…åŒ–æ”¯æŒ**ï¼šä¸­è‹±æ–‡åŒè¯­åˆ‡æ¢ï¼Œå¯æ‰©å±•å¤šè¯­è¨€

## æŠ€æœ¯æ¶æ„

### å‰ç«¯åº”ç”¨æ¶æ„å›¾

```mermaid
graph TB
    subgraph "å‰ç«¯åº”ç”¨æ¶æ„"
        App["App.vue<br/>åº”ç”¨æ ¹ç»„ä»¶"]
        
        subgraph "ä¸‰å¤§æ ¸å¿ƒæ¿å—"
            ProjectManager["ProjectManager.vue<br/>å·¥ç¨‹å­˜æ¡£ç®¡ç†"]
            ResearchTree["ResearchTree.vue<br/>ç ”ç©¶æ ‘å¯è§†åŒ–"]
            MessageCenter["MessageCenter.vue<br/>æ¶ˆæ¯åˆ—è¡¨ä¸AIå¯¹è¯"]
        end
        
        subgraph "å·¥ç¨‹ç®¡ç†ç»„ä»¶"
            ProjectHeader["ProjectHeader.vue<br/>å·¥ç¨‹æ“ä½œå¤´éƒ¨"]
            ProjectList["ProjectList.vue<br/>å·¥ç¨‹åˆ—è¡¨"]
            ProjectDialog["ProjectDialog.vue<br/>å·¥ç¨‹å¯¹è¯æ¡†"]
        end
        
        subgraph "ç ”ç©¶æ ‘ç»„ä»¶"
            TreeVisualization["TreeVisualization.vue<br/>æ€ç»´å¯¼å›¾å¯è§†åŒ–"]
            NodeEditor["NodeEditor.vue<br/>èŠ‚ç‚¹ç¼–è¾‘å™¨"]
            TreeToolbar["TreeToolbar.vue<br/>æ ‘æ“ä½œå·¥å…·æ "]
            SnapshotViewer["SnapshotViewer.vue<br/>å¿«ç…§æŸ¥çœ‹å™¨"]
        end
        
        subgraph "æ¶ˆæ¯å¯¹è¯ç»„ä»¶"
            MessageList["MessageList.vue<br/>æ¶ˆæ¯åˆ—è¡¨"]
            MessageItem["MessageItem.vue<br/>æ¶ˆæ¯é¡¹"]
            ChatInput["ChatInput.vue<br/>å¯¹è¯è¾“å…¥æ¡†"]
            AgentSelector["AgentSelector.vue<br/>æ™ºèƒ½ä½“é€‰æ‹©å™¨"]
            MarkdownRenderer["MarkdownRenderer.vue<br/>Markdownæ¸²æŸ“å™¨"]
        end
        
        subgraph "å…±äº«ç»„ä»¶"
            LoadingSpinner["LoadingSpinner.vue<br/>åŠ è½½æŒ‡ç¤ºå™¨"]
            ConfirmDialog["ConfirmDialog.vue<br/>ç¡®è®¤å¯¹è¯æ¡†"]
            NotificationToast["NotificationToast.vue<br/>é€šçŸ¥æç¤º"]
            LanguageSelector["LanguageSelector.vue<br/>è¯­è¨€åˆ‡æ¢å™¨"]
        end
        
        subgraph "çŠ¶æ€ç®¡ç†"
            ProjectStore["projectStore.js<br/>å·¥ç¨‹çŠ¶æ€ç®¡ç†"]
            TreeStore["treeStore.js<br/>ç ”ç©¶æ ‘çŠ¶æ€ç®¡ç†"]
            MessageStore["messageStore.js<br/>æ¶ˆæ¯çŠ¶æ€ç®¡ç†"]
            UIStore["uiStore.js<br/>UIçŠ¶æ€ç®¡ç†"]
        end
        
        subgraph "æœåŠ¡å±‚"
            APIService["apiService.js<br/>APIæ¥å£æœåŠ¡"]
            SSEService["sseService.js<br/>SSEæµå¼æœåŠ¡"]
            TreeDataService["treeDataService.js<br/>æ ‘æ•°æ®è½¬æ¢æœåŠ¡"]
            StorageService["storageService.js<br/>æœ¬åœ°å­˜å‚¨æœåŠ¡"]
        end
    end
    
    App --> ProjectManager
    App --> ResearchTree
    App --> MessageCenter
    
    ProjectManager --> ProjectHeader
    ProjectManager --> ProjectList
    ProjectManager --> ProjectDialog
    
    ResearchTree --> TreeVisualization
    ResearchTree --> NodeEditor
    ResearchTree --> TreeToolbar
    ResearchTree --> SnapshotViewer
    
    MessageCenter --> MessageList
    MessageCenter --> ChatInput
    MessageCenter --> AgentSelector
    MessageList --> MessageItem
    MessageItem --> MarkdownRenderer
    
    ProjectManager --> ProjectStore
    ResearchTree --> TreeStore
    MessageCenter --> MessageStore
    
    ProjectStore --> APIService
    TreeStore --> APIService
    MessageStore --> SSEService
    
    TreeVisualization --> TreeDataService
    MessageCenter --> StorageService
```

### æ•°æ®æµæ¶æ„å›¾

```mermaid
graph TD
    subgraph "æ•°æ®æµæ¶æ„"
        subgraph "åç«¯APIå±‚"
            ProjectAPI["å·¥ç¨‹ç®¡ç†API<br/>/projects/*"]
            TreeAPI["ç ”ç©¶æ ‘API<br/>/research-tree/*"]
            AgentAPI["æ™ºèƒ½ä½“API<br/>/agents/*"]
        end
        
        subgraph "å‰ç«¯æœåŠ¡å±‚"
            APIClient["APIå®¢æˆ·ç«¯<br/>ç»Ÿä¸€æ¥å£è°ƒç”¨"]
            SSEClient["SSEå®¢æˆ·ç«¯<br/>æµå¼æ•°æ®æ¥æ”¶"]
            DataTransformer["æ•°æ®è½¬æ¢å™¨<br/>åç«¯æ•°æ®â†’å‰ç«¯æ ¼å¼"]
        end
        
        subgraph "çŠ¶æ€ç®¡ç†å±‚"
            GlobalState["å…¨å±€çŠ¶æ€<br/>Pinia Store"]
            ProjectState["å·¥ç¨‹çŠ¶æ€<br/>å½“å‰å·¥ç¨‹ä¿¡æ¯"]
            TreeState["æ ‘çŠ¶æ€<br/>ç ”ç©¶æ ‘æ•°æ®"]
            MessageState["æ¶ˆæ¯çŠ¶æ€<br/>æ¶ˆæ¯å†å²"]
            UIState["UIçŠ¶æ€<br/>ç•Œé¢æ§åˆ¶"]
        end
        
        subgraph "ç»„ä»¶å±‚"
            ProjectComponents["å·¥ç¨‹ç®¡ç†ç»„ä»¶"]
            TreeComponents["ç ”ç©¶æ ‘ç»„ä»¶"]
            MessageComponents["æ¶ˆæ¯å¯¹è¯ç»„ä»¶"]
        end
        
        subgraph "è§†å›¾å±‚"
            MindElixir["Mind-elixir<br/>æ€ç»´å¯¼å›¾æ¸²æŸ“"]
            ElementPlus["Element Plus<br/>UIç»„ä»¶åº“"]
            MarkdownIt["Markdown-it<br/>æ–‡æœ¬æ¸²æŸ“"]
        end
    end
    
    ProjectAPI --> APIClient
    TreeAPI --> APIClient
    AgentAPI --> SSEClient
    
    APIClient --> DataTransformer
    SSEClient --> DataTransformer
    
    DataTransformer --> GlobalState
    GlobalState --> ProjectState
    GlobalState --> TreeState
    GlobalState --> MessageState
    GlobalState --> UIState
    
    ProjectState --> ProjectComponents
    TreeState --> TreeComponents
    MessageState --> MessageComponents
    UIState --> ProjectComponents
    UIState --> TreeComponents
    UIState --> MessageComponents
    
    TreeComponents --> MindElixir
    ProjectComponents --> ElementPlus
    MessageComponents --> ElementPlus
    MessageComponents --> MarkdownIt
```

### å‰ç«¯æŠ€æœ¯æ ˆæ¶æ„å›¾

```mermaid
graph TB
    subgraph "å‰ç«¯æŠ€æœ¯æ ˆ"
        subgraph "æ ¸å¿ƒæ¡†æ¶"
            Vue3["Vue 3<br/>â€¢ Options APIé£æ ¼<br/>â€¢ å“åº”å¼ç³»ç»Ÿ<br/>â€¢ ç»„ä»¶åŒ–å¼€å‘"]
            VueCLI["Vue CLI<br/>â€¢ é¡¹ç›®è„šæ‰‹æ¶<br/>â€¢ æ„å»ºå·¥å…·<br/>â€¢ å¼€å‘æœåŠ¡å™¨"]
        end
        
        subgraph "çŠ¶æ€ç®¡ç†"
            Pinia["Pinia<br/>â€¢ è½»é‡çº§çŠ¶æ€ç®¡ç†<br/>â€¢ Vue 3å…¼å®¹<br/>â€¢ æ¨¡å—åŒ–è®¾è®¡"]
        end
        
        subgraph "UIç»„ä»¶åº“"
            ElementPlus["Element Plus<br/>â€¢ ä¸°å¯Œçš„ç»„ä»¶<br/>â€¢ ä¸»é¢˜å®šåˆ¶<br/>â€¢ å›½é™…åŒ–æ”¯æŒ"]
        end
        
        subgraph "å¯è§†åŒ–ç»„ä»¶"
            MindElixir["Mind-elixir<br/>â€¢ æ€ç»´å¯¼å›¾æ¸²æŸ“<br/>â€¢ äº¤äº’å¼ç¼–è¾‘<br/>â€¢ è‡ªå®šä¹‰æ ·å¼"]
        end
        
        subgraph "æ–‡æœ¬å¤„ç†"
            MarkdownIt["Markdown-it<br/>â€¢ Markdownæ¸²æŸ“<br/>â€¢ æ’ä»¶æ‰©å±•<br/>â€¢ è¯­æ³•é«˜äº®"]
        end
        
        subgraph "ç½‘ç»œé€šä¿¡"
            Axios["Axios<br/>â€¢ HTTPè¯·æ±‚<br/>â€¢ æ‹¦æˆªå™¨<br/>â€¢ é”™è¯¯å¤„ç†"]
            EventSource["EventSource<br/>â€¢ SSEè¿æ¥<br/>â€¢ è‡ªåŠ¨é‡è¿<br/>â€¢ é”™è¯¯æ¢å¤"]
        end
        
        subgraph "å›½é™…åŒ–"
            VueI18n["Vue I18n<br/>â€¢ å¤šè¯­è¨€æ”¯æŒ<br/>â€¢ åŠ¨æ€åˆ‡æ¢<br/>â€¢ æ ¼å¼åŒ–"]
        end
        
        subgraph "å·¥å…·åº“"
            Lodash["Lodash<br/>â€¢ å·¥å…·å‡½æ•°<br/>â€¢ æ•°æ®å¤„ç†"]
            DayJS["Day.js<br/>â€¢ æ—¶é—´å¤„ç†<br/>â€¢ è½»é‡çº§"]
        end
        

    end
    
    Vue3 --> Pinia
    Vue3 --> ElementPlus
    Vue3 --> VueI18n
    Vue3 --> MindElixir
    Vue3 --> MarkdownIt
    
    Pinia --> Axios
    Pinia --> EventSource
    
    Vue3 --> Lodash
    Vue3 --> DayJS
```

### æŠ€æœ¯æ ˆé€‰æ‹©

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Vue 3 | ^3.3.0 | æ ¸å¿ƒæ¡†æ¶ï¼Œä½¿ç”¨ Options API é£æ ¼ |
| Vue CLI | ^5.0.0 | æ„å»ºå·¥å…·ï¼Œé¡¹ç›®è„šæ‰‹æ¶å’Œå¼€å‘æœåŠ¡å™¨ |
| Pinia | ^2.1.0 | çŠ¶æ€ç®¡ç†ï¼Œæ›¿ä»£ Vuex |
| Element Plus | ^2.3.0 | UI ç»„ä»¶åº“ï¼Œä¸°å¯Œçš„ç»„ä»¶ç”Ÿæ€ |
| Mind-elixir | ^1.0.0 | æ€ç»´å¯¼å›¾å¯è§†åŒ–å¼•æ“ |
| Markdown-it | ^13.0.0 | Markdown æ¸²æŸ“å¼•æ“ |
| Axios | ^1.5.0 | HTTP å®¢æˆ·ç«¯ |
| Vue I18n | ^9.4.0 | å›½é™…åŒ–è§£å†³æ–¹æ¡ˆ |


### æ•´ä½“æ¶æ„è®¾è®¡

å‰ç«¯é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œä»ä¸‹åˆ°ä¸Šåˆ†ä¸ºï¼š

1. **æœåŠ¡å±‚ï¼ˆService Layerï¼‰**ï¼šè´Ÿè´£ä¸åç«¯ API é€šä¿¡å’Œæ•°æ®å¤„ç†
2. **çŠ¶æ€ç®¡ç†å±‚ï¼ˆState Managementï¼‰**ï¼šä½¿ç”¨ Pinia ç®¡ç†å…¨å±€çŠ¶æ€
3. **ç»„ä»¶å±‚ï¼ˆComponent Layerï¼‰**ï¼šå¯å¤ç”¨çš„ Vue ç»„ä»¶
4. **è§†å›¾å±‚ï¼ˆView Layerï¼‰**ï¼šé¡µé¢çº§ç»„ä»¶å’Œè·¯ç”±ç®¡ç†

## åŠŸèƒ½æ¨¡å—è®¾è®¡

### 1. å·¥ç¨‹å­˜æ¡£ç®¡ç†æ¨¡å—

#### åŠŸèƒ½éœ€æ±‚
- å·¥ç¨‹çš„åˆ›å»ºã€ä¿å­˜ã€åŠ è½½ã€åˆ é™¤
- å·¥ç¨‹åˆ—è¡¨å±•ç¤ºå’Œæœç´¢è¿‡æ»¤
- å·¥ç¨‹ä¿¡æ¯å±•ç¤ºï¼ˆåç§°ã€åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ã€å¿«ç…§æ•°é‡ï¼‰
- å¦å­˜ä¸ºåŠŸèƒ½ï¼Œæ”¯æŒå·¥ç¨‹å¤åˆ¶

#### ç»„ä»¶è®¾è®¡
```
ProjectManager.vue (ä¸»ç»„ä»¶)
â”œâ”€â”€ ProjectHeader.vue (å·¥ç¨‹æ“ä½œå¤´éƒ¨)
â”œâ”€â”€ ProjectList.vue (å·¥ç¨‹åˆ—è¡¨)
â”œâ”€â”€ ProjectDialog.vue (å·¥ç¨‹å¯¹è¯æ¡†)
â””â”€â”€ ProjectInfo.vue (å·¥ç¨‹ä¿¡æ¯å±•ç¤º)
```

#### çŠ¶æ€ç®¡ç†
```javascript
// projectStore.js
export const useProjectStore = defineStore('project', {
  state: () => ({
    currentProject: null,      // å½“å‰å·¥ç¨‹ä¿¡æ¯
    projectList: [],          // å·¥ç¨‹åˆ—è¡¨
    isLoading: false,         // åŠ è½½çŠ¶æ€
    lastSaveTime: null        // æœ€åä¿å­˜æ—¶é—´
  }),
  
  actions: {
    async createProject(name),
    async saveProject(),
    async loadProject(name),
    async deleteProject(name),
    async fetchProjectList()
  }
})
```

#### API æ¥å£å¯¹æ¥

âš ï¸ **é‡è¦**ï¼šä»¥ä¸‹æ¥å£è¯´æ˜åŸºäºåç«¯å®é™…ä»£ç ï¼Œä¸åŸè®¾è®¡æœ‰å·®å¼‚

**å·¥ç¨‹ç®¡ç†æ¥å£**
- `POST /projects?project_name={name}` - åˆ›å»ºå·¥ç¨‹ï¼ˆä½¿ç”¨queryå‚æ•°ï¼Œébodyï¼‰
- `GET /projects` - è·å–å·¥ç¨‹åˆ—è¡¨
- `GET /projects/{project_name}` - åŠ è½½å·¥ç¨‹
- `POST /projects/save` - ä¿å­˜å½“å‰å·¥ç¨‹
- `POST /projects/save-as?new_project_name={name}` - å¦å­˜ä¸ºå·¥ç¨‹ï¼ˆä½¿ç”¨queryå‚æ•°ï¼‰
- `DELETE /projects/{project_name}` - åˆ é™¤å·¥ç¨‹

**æ•°æ®ç»“æ„æ˜ å°„**
```javascript
// åç«¯è¿”å›æ ¼å¼
{
  success: true,
  projects: [
    {
      project_name: "æµ‹è¯•1",  // æ³¨æ„ï¼šå­—æ®µåæ˜¯project_name
      created_at: "2025-08-29T12:29:39.253808",
      updated_at: "2025-08-31T09:45:57.599869",
      file_path: "..."
    }
  ]
}

// å‰ç«¯è½¬æ¢åæ ¼å¼
{
  name: "æµ‹è¯•1",           // è½¬æ¢ä¸ºnameå­—æ®µ
  created_at: "...",
  updated_at: "...",
  file_path: "..."
}
```

### 2. ç ”ç©¶æ ‘å¯è§†åŒ–æ¨¡å—

#### åŠŸèƒ½éœ€æ±‚

**âœ… å½“å‰é˜¶æ®µå®ç°åŠŸèƒ½ï¼š**
- åŸºäº Mind-elixir çš„æ€ç»´å¯¼å›¾æ¸²æŸ“
- æ”¯æŒé—®é¢˜èŠ‚ç‚¹ï¼ˆå®æ–½é—®é¢˜ã€æ¡ä»¶é—®é¢˜ï¼‰å’Œè§£å†³æ–¹æ¡ˆèŠ‚ç‚¹çš„æ­£ç¡®æ˜¾ç¤º
- èŠ‚ç‚¹æ ·å¼åŒºåˆ†ï¼šå¤šå±‚æ¬¡å¯æ‰©å±•çš„èŠ‚ç‚¹æ ·å¼ç³»ç»Ÿï¼ˆåŸºç¡€ç±»å‹ã€çŠ¶æ€ã€é«˜äº®ç­‰ï¼‰
- å¿«ç…§æŸ¥çœ‹ï¼šä¸´æ—¶æ˜¾ç¤ºå†å²å¿«ç…§çŠ¶æ€
- é€‰ä¸­æ–¹æ¡ˆç®¡ç†ï¼šå¯è§†åŒ–æ˜¾ç¤ºå½“å‰é€‰ä¸­çš„è§£å†³æ–¹æ¡ˆ
- èŠ‚ç‚¹ä¿¡æ¯å±•ç¤ºï¼šæ˜¾ç¤ºèŠ‚ç‚¹è¯¦ç»†ä¿¡æ¯ï¼ˆåªè¯»æ¨¡å¼ï¼‰

**ğŸš§ æš‚ä¸å®ç°åŠŸèƒ½ï¼ˆç•™å¾…åç»­ç‰ˆæœ¬ï¼‰ï¼š**
- âŒ äº¤äº’å¼ç¼–è¾‘ï¼šèŠ‚ç‚¹çš„åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤
- âŒ çº¦æŸéªŒè¯ï¼šç¼–è¾‘æƒé™å’Œä¸šåŠ¡è§„åˆ™æ£€æŸ¥
- âŒ æ‹–æ‹½æ“ä½œï¼šèŠ‚ç‚¹ä½ç½®è°ƒæ•´å’Œå±‚çº§å˜æ›´
- âŒ å³é”®èœå•ï¼šèŠ‚ç‚¹æ“ä½œèœå•
- âŒ å®æ—¶ç¼–è¾‘åŒæ­¥ï¼šå¤šç”¨æˆ·ååŒç¼–è¾‘

#### ç»„ä»¶è®¾è®¡
```
ResearchTree.vue (ä¸»ç»„ä»¶) âœ…
â”œâ”€â”€ MindElixirWrapper.vue (Mind-elixiråŒ…è£…å™¨) âœ…
â”œâ”€â”€ NodeInfoPanel.vue (èŠ‚ç‚¹ä¿¡æ¯é¢æ¿) âœ…
â”œâ”€â”€ SnapshotControls.vue (å¿«ç…§æ§åˆ¶å™¨) âœ…
â””â”€â”€ services/
    â”œâ”€â”€ ResearchTreeTransformer.js (æ•°æ®è½¬æ¢æœåŠ¡) âœ…
    â””â”€â”€ MindElixirConfig.js (Mind-elixiré…ç½®) âœ…
```

##### æ ¸å¿ƒç»„ä»¶å®ç°
```vue
<!-- MindElixirWrapper.vue - Mind-elixiråŒ…è£…å™¨ -->
<template>
  <div class="mind-elixir-container">
    <div ref="mindElixirEl" class="mind-elixir-canvas"></div>
    <div v-if="isSnapshotView" class="snapshot-indicator">
      ğŸ“¸ æ­£åœ¨æŸ¥çœ‹å†å²å¿«ç…§
      <el-button size="small" @click="exitSnapshotView">è¿”å›å½“å‰</el-button>
    </div>
  </div>
</template>

<script>
import MindElixir from 'mind-elixir'
import { ResearchTreeTransformer } from '@/services/ResearchTreeTransformer'
import { MindElixirConfig } from '@/services/MindElixirConfig'

export default {
  name: 'MindElixirWrapper',
  props: {
    snapshotData: Object,
    isSnapshotView: Boolean,
    agentOperatingNodeId: String
  },
  emits: ['node-selected', 'exit-snapshot-view'],
  
  data() {
    return {
      mindElixir: null,
      transformer: new ResearchTreeTransformer()
    }
  },
  
  mounted() {
    this.initMindElixir()
  },
  
  beforeUnmount() {
    if (this.mindElixir) {
      this.mindElixir.destroy()
    }
  },
  
  watch: {
    snapshotData: {
      handler(newData) {
        if (newData && this.mindElixir) {
          this.updateMindMap(newData)
        }
      },
      deep: true
    },
    
    agentOperatingNodeId(newNodeId) {
      // æ›´æ–°æ™ºèƒ½ä½“æ“ä½œçŠ¶æ€
      this.updateAgentOperatingNode(newNodeId)
    }
  },
  
  methods: {
    initMindElixir() {
      const config = MindElixirConfig.getReadOnlyConfig({
        el: this.$refs.mindElixirEl,
        onNodeSelect: this.handleNodeSelect
      })
      
      this.mindElixir = new MindElixir(config)
      
      if (this.snapshotData) {
        this.updateMindMap(this.snapshotData)
      }
    },
    
    updateMindMap(snapshotData) {
      const context = {
        isSnapshotView: this.isSnapshotView,
        agentOperatingNodeId: this.agentOperatingNodeId
      }
      
      const mindElixirData = this.transformer.transformToMindElixir(snapshotData, context)
      
      if (mindElixirData.theme) {
        this.mindElixir.changeTheme(mindElixirData.theme)
      }
      
      this.mindElixir.refresh(mindElixirData)
    },
    
    handleNodeSelect(nodeObj) {
      this.$emit('node-selected', {
        id: nodeObj.id,
        title: nodeObj.topic,
        data: nodeObj
      })
    },
    
    updateAgentOperatingNode(nodeId) {
      // é€šè¿‡é‡æ–°æ¸²æŸ“æ›´æ–°æ™ºèƒ½ä½“æ“ä½œçŠ¶æ€
      if (this.snapshotData) {
        this.updateMindMap(this.snapshotData)
      }
    },
    
    exitSnapshotView() {
      this.$emit('exit-snapshot-view')
    }
  }
}
</script>
```

##### Mind-elixiré…ç½®æœåŠ¡
```javascript
// MindElixirConfig.js - Mind-elixiré…ç½®ç®¡ç†
export class MindElixirConfig {
  // è·å–åªè¯»æ¨¡å¼é…ç½®
  static getReadOnlyConfig(options = {}) {
    return {
      el: options.el,
      direction: MindElixir.SIDE,
      locale: 'zh_CN',
      
      // ç¦ç”¨æ‰€æœ‰ç¼–è¾‘åŠŸèƒ½
      draggable: false,
      editable: false,
      contextMenu: false,
      toolBar: false,
      keypress: false,
      
      // ç¦ç”¨æ‰€æœ‰ç¼–è¾‘æ“ä½œ
      before: {
        insertSibling: () => false,
        insertParent: () => false,
        addChild: () => false,
        removeNode: () => false,
        removeNodes: () => false,
        moveNode: () => false,
        moveUpNode: () => false,
        moveDownNode: () => false,
        moveNodeIn: () => false,
        moveNodeBefore: () => false,
        moveNodeAfter: () => false,
        copyNode: () => false,
        copyNodes: () => false,
        beginEdit: () => false
      },
      
      // è‡ªå®šä¹‰äº‹ä»¶å¤„ç†
      ...this.getEventHandlers(options)
    }
  }
  
  // è·å–äº‹ä»¶å¤„ç†å™¨
  static getEventHandlers(options) {
    const handlers = {}
    
    // èŠ‚ç‚¹é€‰æ‹©äº‹ä»¶
    if (options.onNodeSelect) {
      handlers.onNodeSelect = options.onNodeSelect
    }
    
    return handlers
  }
  
  // è·å–ä¸»é¢˜é…ç½®
  static getTheme(themeName = 'default') {
    const themes = {
      default: {
        name: 'Default',
        palette: ['#848FA0', '#748BE9', '#D2F9FE', '#4145A5', '#789AFA'],
        cssVar: {
          '--main-color': '#444446',
          '--main-bgcolor': '#ffffff',
          '--color': '#777777',
          '--bgcolor': '#f6f6f6'
        }
      },
      snapshot: {
        name: 'Snapshot',
        palette: ['#bdc3c7', '#95a5a6', '#7f8c8d', '#34495e', '#2c3e50'],
        cssVar: {
          '--main-color': '#666666',
          '--main-bgcolor': '#f5f5f5',
          '--color': '#999999',
          '--bgcolor': '#fafafa'
        }
      }
    }
    
    return themes[themeName] || themes.default
  }
}
```

#### ç ”ç©¶æ ‘æ•°æ®è½¬æ¢æ¶æ„å›¾

```mermaid
graph TD
    subgraph "ç ”ç©¶æ ‘æ•°æ®è½¬æ¢æ¶æ„"
        subgraph "åç«¯æ•°æ®æ ¼å¼"
            BackendSnapshot["å¿«ç…§æ•°æ®<br/>â€¢ id, created_at<br/>â€¢ roots[]"]
            BackendNode["èŠ‚ç‚¹æ•°æ®<br/>â€¢ id, type, title<br/>â€¢ children[]"]
            ProblemNode["é—®é¢˜èŠ‚ç‚¹<br/>â€¢ problem_type<br/>â€¢ significance<br/>â€¢ criteria<br/>â€¢ selected_solution_id"]
            SolutionNode["è§£å†³æ–¹æ¡ˆèŠ‚ç‚¹<br/>â€¢ top_level_thoughts<br/>â€¢ finishing_task<br/>â€¢ plan_justification<br/>â€¢ state"]
        end
        
        subgraph "æ•°æ®è½¬æ¢å±‚"
            TreeTransformer["æ ‘æ•°æ®è½¬æ¢å™¨<br/>TreeDataTransformer"]
            NodeStyler["èŠ‚ç‚¹æ ·å¼å™¨<br/>NodeStyler"]
            ConstraintValidator["çº¦æŸéªŒè¯å™¨<br/>ConstraintValidator"]
        end
        
        subgraph "Mind-elixiræ ¼å¼"
            MindData["æ€ç»´å¯¼å›¾æ•°æ®<br/>â€¢ nodeData<br/>â€¢ linkData"]
            MindNode["å¯¼å›¾èŠ‚ç‚¹<br/>â€¢ id, topic, style<br/>â€¢ children[]"]
            NodeStyle["èŠ‚ç‚¹æ ·å¼<br/>â€¢ backgroundColor<br/>â€¢ borderColor<br/>â€¢ textColor"]
        end
        
        subgraph "æ ·å¼å®šä¹‰"
            ProblemStyle["é—®é¢˜èŠ‚ç‚¹æ ·å¼<br/>â€¢ å®æ–½é—®é¢˜ï¼šè“è‰²<br/>â€¢ æ¡ä»¶é—®é¢˜ï¼šæ©™è‰²"]
            SolutionStyle["è§£å†³æ–¹æ¡ˆæ ·å¼<br/>â€¢ è¿›è¡Œä¸­ï¼šé»„è‰²<br/>â€¢ æˆåŠŸï¼šç»¿è‰²<br/>â€¢ å¤±è´¥ï¼šçº¢è‰²<br/>â€¢ é€‰ä¸­ï¼šåŠ ç²—è¾¹æ¡†"]
        end
        
        subgraph "äº¤äº’çº¦æŸ"
            EditConstraints["ç¼–è¾‘çº¦æŸ<br/>â€¢ æ¡ä»¶é—®é¢˜ä¸èƒ½æœ‰è§£å†³æ–¹æ¡ˆ<br/>â€¢ æ ¹é—®é¢˜å¿…é¡»æ˜¯å®æ–½ç±»å‹"]
            SelectConstraints["é€‰æ‹©çº¦æŸ<br/>â€¢ åªèƒ½é€‰æ‹©åŒä¸€é—®é¢˜ä¸‹çš„æ–¹æ¡ˆ<br/>â€¢ é€‰ä¸­æ–¹æ¡ˆå½±å“å­æ ‘æ˜¾ç¤º"]
        end
    end
    
    BackendSnapshot --> TreeTransformer
    BackendNode --> TreeTransformer
    ProblemNode --> TreeTransformer
    SolutionNode --> TreeTransformer
    
    TreeTransformer --> NodeStyler
    TreeTransformer --> ConstraintValidator
    
    NodeStyler --> MindData
    NodeStyler --> MindNode
    NodeStyler --> NodeStyle
    
    ProblemStyle --> NodeStyler
    SolutionStyle --> NodeStyler
    
    ConstraintValidator --> EditConstraints
    ConstraintValidator --> SelectConstraints
    
    MindData --> MindNode
```

#### æ•°æ®è½¬æ¢è®¾è®¡

**åç«¯æ•°æ®æ ¼å¼ â†’ Mind-elixir æ ¼å¼è½¬æ¢**

```javascript
// åç«¯å¿«ç…§æ•°æ®ç»“æ„
{
  id: "snapshot_id",
  created_at: "2024-01-01T00:00:00Z",
  roots: [
    {
      id: "node_id",
      type: "problem",
      title: "ç ”ç©¶é—®é¢˜æ ‡é¢˜",
      problem_type: "implementation", // æˆ– "conditional"
      selected_solution_id: "solution_id",
      children: [...]
    }
  ]
}

// è½¬æ¢ä¸º Mind-elixir æ ¼å¼
{
  nodeData: {
    id: "root",
    topic: "ç ”ç©¶æ ‘",
    children: [
      {
        id: "node_id",
        topic: "ç ”ç©¶é—®é¢˜æ ‡é¢˜",
        style: {
          backgroundColor: "#409eff", // å®æ–½é—®é¢˜è“è‰²
          borderColor: "#409eff",
          color: "#ffffff"
        },
        children: [...]
      }
    ]
  }
}
```

#### èŠ‚ç‚¹æ ·å¼è®¾è®¡ï¼ˆåŸºäºMind-elixiråŸç”Ÿå±æ€§ï¼‰

åŸºäºMind-elixirçš„åŸç”Ÿæ ·å¼ç³»ç»Ÿï¼Œä½¿ç”¨`style`ã€`tags`ã€`icons`å±æ€§å®ç°èŠ‚ç‚¹çš„è§†è§‰åŒºåˆ†ï¼š

##### èŠ‚ç‚¹ç±»å‹æ ·å¼æ˜ å°„
```javascript
// èŠ‚ç‚¹æ ·å¼é…ç½® - ä½¿ç”¨Mind-elixiråŸç”Ÿå±æ€§
const NodeStyleConfig = {
  // åŸºç¡€èŠ‚ç‚¹ç±»å‹æ ·å¼
  nodeTypes: {
    implementation_problem: {
      style: {
        background: '#e6f7ff',
        color: '#1890ff'
      },
      tags: ['å®æ–½é—®é¢˜']
    },
    conditional_problem: {
      style: {
        background: '#fff1f0',
        color: '#ff4d4f'
      },
      tags: ['æ¡ä»¶é—®é¢˜']
    },
    solution: {
      style: {
        background: '#f9f0ff',
        color: '#722ed1'
      },
      tags: ['è§£å†³æ–¹æ¡ˆ']
    }
  },
  
  // çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆä½¿ç”¨å›¾æ ‡ï¼‰
  statusIcons: {
    pending: '',           // æ— å›¾æ ‡
    in_progress: 'ğŸ”„',     // è¿›è¡Œä¸­
    completed: 'âœ…',       // å·²å®Œæˆ
    failed: 'âŒ'           // å¤±è´¥
  },
  
  // ç‰¹æ®ŠçŠ¶æ€æ ‡è¯†
  specialMarkers: {
    selected_solution: 'â­',    // é€‰ä¸­çš„è§£å†³æ–¹æ¡ˆ
    agent_operating: 'ğŸ¤–',     // æ™ºèƒ½ä½“æ­£åœ¨æ“ä½œ
    snapshot_view: 'ğŸ“¸'        // å¿«ç…§æŸ¥çœ‹çŠ¶æ€
  }
}
```

##### æ•°æ®è½¬æ¢å™¨å®ç°
```javascript
// ç ”ç©¶æ ‘æ•°æ®è½¬æ¢å™¨
class ResearchTreeTransformer {
  constructor() {
    this.styleConfig = NodeStyleConfig
  }
  
  // å°†åç«¯ç ”ç©¶æ ‘æ•°æ®è½¬æ¢ä¸ºMind-elixiræ ¼å¼
  transformToMindElixir(backendSnapshot, context = {}) {
    if (!backendSnapshot || !backendSnapshot.roots || backendSnapshot.roots.length === 0) {
      return this.createEmptyMindMap()
    }
    
    // ä½¿ç”¨ç¬¬ä¸€ä¸ªæ ¹èŠ‚ç‚¹ä½œä¸ºæ€ç»´å¯¼å›¾æ ¹èŠ‚ç‚¹
    const rootNode = backendSnapshot.roots[0]
    
    return {
      nodeData: this.transformNode(rootNode, context, true),
      theme: this.getTheme(context)
    }
  }
  
  // è½¬æ¢å•ä¸ªèŠ‚ç‚¹
  transformNode(node, context, isRoot = false) {
    const mindElixirNode = {
      id: node.id,
      topic: node.title,
      children: []
    }
    
    // æ ¹èŠ‚ç‚¹ç‰¹æ®Šå¤„ç†
    if (isRoot) {
      mindElixirNode.root = true
      return {
        ...mindElixirNode,
        children: node.children ? node.children.map(child => 
          this.transformNode(child, context)
        ) : []
      }
    }
    
    // åº”ç”¨èŠ‚ç‚¹æ ·å¼
    this.applyNodeStyle(mindElixirNode, node, context)
    
    // é€’å½’å¤„ç†å­èŠ‚ç‚¹
    if (node.children && node.children.length > 0) {
      mindElixirNode.children = node.children.map(child => 
        this.transformNode(child, context)
      )
    }
    
    return mindElixirNode
  }
  
  // åº”ç”¨èŠ‚ç‚¹æ ·å¼
  applyNodeStyle(mindElixirNode, backendNode, context) {
    const nodeType = this.getNodeType(backendNode)
    const baseStyle = this.styleConfig.nodeTypes[nodeType]
    
    if (baseStyle) {
      mindElixirNode.style = { ...baseStyle.style }
      mindElixirNode.tags = [...baseStyle.tags]
    }
    
    // æ·»åŠ çŠ¶æ€å›¾æ ‡
    const icons = []
    
    // çŠ¶æ€å›¾æ ‡
    if (backendNode.state) {
      const statusIcon = this.styleConfig.statusIcons[backendNode.state]
      if (statusIcon) icons.push(statusIcon)
    }
    
    // é€‰ä¸­æ–¹æ¡ˆæ ‡è¯†
    if (backendNode.type === 'solution' && 
        backendNode.parent && 
        backendNode.parent.selected_solution_id === backendNode.id) {
      icons.push(this.styleConfig.specialMarkers.selected_solution)
    }
    
    // æ™ºèƒ½ä½“æ“ä½œæ ‡è¯†
    if (context.agentOperatingNodeId === backendNode.id) {
      icons.push(this.styleConfig.specialMarkers.agent_operating)
    }
    
    // å¿«ç…§æŸ¥çœ‹çŠ¶æ€
    if (context.isSnapshotView) {
      icons.push(this.styleConfig.specialMarkers.snapshot_view)
      // å¿«ç…§æŸ¥çœ‹æ—¶é™ä½é€æ˜åº¦
      mindElixirNode.style.opacity = '0.8'
    }
    
    if (icons.length > 0) {
      mindElixirNode.icons = icons
    }
  }
  
  // ç¡®å®šèŠ‚ç‚¹ç±»å‹
  getNodeType(node) {
    if (node.type === 'solution') {
      return 'solution'
    } else if (node.type === 'problem') {
      return node.problem_type === 'implementation' ? 
        'implementation_problem' : 'conditional_problem'
    }
    return 'implementation_problem' // é»˜è®¤
  }
  
  // è·å–ä¸»é¢˜é…ç½®
  getTheme(context) {
    return context.isSnapshotView ? {
      name: 'Snapshot',
      cssVar: {
        '--main-bgcolor': '#f5f5f5',
        '--bgcolor': '#fafafa'
      }
    } : null
  }
  
  // åˆ›å»ºç©ºæ€ç»´å¯¼å›¾
  createEmptyMindMap() {
    return {
      nodeData: {
        id: 'empty-root',
        topic: 'æš‚æ— æ•°æ®',
        root: true,
        children: []
      }
    }
  }
}
```

#### API æ¥å£å¯¹æ¥

**âœ… å½“å‰é˜¶æ®µå®ç°çš„æ¥å£ï¼š**
- `GET /research-tree/snapshots/current` - è·å–å½“å‰ç ”ç©¶æ ‘å¿«ç…§
- `GET /research-tree/snapshots/{snapshot_id}` - è·å–æŒ‡å®šå¿«ç…§æ•°æ®

**ğŸš§ åç»­ç‰ˆæœ¬æ¥å£ï¼ˆæš‚ä¸å®ç°ï¼‰ï¼š**
- `POST /research-tree/nodes` - åˆ›å»ºæ–°èŠ‚ç‚¹
- `PUT /research-tree/nodes/{node_id}` - æ›´æ–°èŠ‚ç‚¹å†…å®¹
- `DELETE /research-tree/nodes/{node_id}` - åˆ é™¤èŠ‚ç‚¹
- `POST /research-tree/nodes/{node_id}/children` - æ·»åŠ å­èŠ‚ç‚¹
- `PUT /research-tree/solutions/{solution_id}/select` - é€‰æ‹©è§£å†³æ–¹æ¡ˆ

#### äº¤äº’çº¦æŸå®ç°ï¼ˆæš‚ä¸å®ç°ï¼‰

> âš ï¸ **æ³¨æ„**ï¼šä»¥ä¸‹çº¦æŸéªŒè¯åŠŸèƒ½å±äºäº¤äº’å¼ç¼–è¾‘åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨å½“å‰é˜¶æ®µæš‚ä¸å®ç°ã€‚ä»…ä½œä¸ºåç»­ç‰ˆæœ¬çš„è®¾è®¡å‚è€ƒã€‚

```javascript
// çº¦æŸéªŒè¯å™¨ï¼ˆé¢„ç•™æ¥å£ï¼‰
class ConstraintValidator {
  // æ¡ä»¶é—®é¢˜ä¸èƒ½æœ‰è§£å†³æ–¹æ¡ˆ
  canAddSolution(problemNode) {
    return problemNode.problem_type === 'implementation';
  }
  
  // æ ¹é—®é¢˜å¿…é¡»æ˜¯å®æ–½ç±»å‹
  canSetAsRoot(problemNode) {
    return problemNode.problem_type === 'implementation';
  }
  
  // æ£€æŸ¥ç¼–è¾‘æƒé™
  canEditNode(nodeId) {
    return !this.isAgentWorking();
  }
}
```

### 3. æ¶ˆæ¯åˆ—è¡¨å’ŒAIå¯¹è¯æ¨¡å—

#### åŠŸèƒ½éœ€æ±‚
- æ”¯æŒä¸‰ç§æ¶ˆæ¯ç±»å‹ï¼šç”¨æˆ·æ¶ˆæ¯ã€æ™ºèƒ½ä½“æ¶ˆæ¯ã€ç³»ç»Ÿæ¶ˆæ¯
- æ¶ˆæ¯ç»“æ„ï¼šæ ‡é¢˜ â†’ å†…å®¹ â†’ æ€è€ƒçš„ä¸‰å±‚å±•å¼€ç»“æ„
- æ¶ˆæ¯æ“ä½œï¼šæŸ¥çœ‹å¿«ç…§ã€å›æº¯æ¶ˆæ¯ã€å¤åˆ¶å†…å®¹
- æ™ºèƒ½ä½“é€‰æ‹©å’ŒèŠ‚ç‚¹é€‰æ‹©
- SSE æµå¼æ•°æ®æ¥æ”¶å’Œå®æ—¶æ›´æ–°
- ç»ˆæ­¢ç”ŸæˆåŠŸèƒ½

#### ç»„ä»¶è®¾è®¡
```
MessageCenter.vue (ä¸»ç»„ä»¶)
â”œâ”€â”€ MessageList.vue (æ¶ˆæ¯åˆ—è¡¨)
â”‚   â””â”€â”€ MessageItem.vue (æ¶ˆæ¯é¡¹)
â”‚       â”œâ”€â”€ MessageHeader.vue (æ¶ˆæ¯å¤´éƒ¨)
â”‚       â”œâ”€â”€ MessageContent.vue (æ¶ˆæ¯å†…å®¹)
â”‚       â””â”€â”€ MessageActions.vue (æ¶ˆæ¯æ“ä½œ)
â”œâ”€â”€ ChatInput.vue (è¾“å…¥æ¡†)
â”œâ”€â”€ AgentSelector.vue (æ™ºèƒ½ä½“é€‰æ‹©å™¨)
â”œâ”€â”€ NodeSelector.vue (èŠ‚ç‚¹é€‰æ‹©å™¨)
â””â”€â”€ MarkdownRenderer.vue (Markdownæ¸²æŸ“å™¨)
```

#### æ¶ˆæ¯ç³»ç»Ÿæ¶æ„å›¾

```mermaid
graph TB
    subgraph "æ¶ˆæ¯ç³»ç»Ÿæ¶æ„"
        subgraph "æ¶ˆæ¯ç±»å‹"
            UserMsg["ç”¨æˆ·æ¶ˆæ¯<br/>â€¢ å¤´åƒå³ä¾§<br/>â€¢ è“è‰²ä¸»é¢˜"]
            AgentMsg["æ™ºèƒ½ä½“æ¶ˆæ¯<br/>â€¢ å¤´åƒå·¦ä¾§<br/>â€¢ æ˜¾ç¤ºä¸“å®¶èº«ä»½"]
            SystemMsg["ç³»ç»Ÿæ¶ˆæ¯<br/>â€¢ å¤´åƒå·¦ä¾§<br/>â€¢ ç°è‰²ä¸»é¢˜"]
        end
        
        subgraph "æ¶ˆæ¯ç»“æ„"
            MsgHeader["æ¶ˆæ¯å¤´éƒ¨<br/>â€¢ å‘é€è€…ä¿¡æ¯<br/>â€¢ æ—¶é—´æˆ³<br/>â€¢ çŠ¶æ€æŒ‡ç¤º"]
            MsgTitle["æ¶ˆæ¯æ ‡é¢˜<br/>â€¢ å¯æŠ˜å <br/>â€¢ é»˜è®¤å±•å¼€"]
            MsgContent["æ¶ˆæ¯å†…å®¹<br/>â€¢ Markdownæ¸²æŸ“<br/>â€¢ å¯æŠ˜å "]
            MsgThinking["æ€è€ƒè¿‡ç¨‹<br/>â€¢ æ·¡è‰²æ˜¾ç¤º<br/>â€¢ å¯æŠ˜å <br/>â€¢ é»˜è®¤æ”¶èµ·"]
        end
        
        subgraph "æ¶ˆæ¯æ“ä½œ"
            ViewSnapshot["æŸ¥çœ‹å¿«ç…§<br/>â€¢ ä¸´æ—¶æ˜¾ç¤º<br/>â€¢ ç•Œé¢æç¤º"]
            RollbackMsg["å›æº¯æ¶ˆæ¯<br/>â€¢ åˆ é™¤åç»­<br/>â€¢ ç¡®è®¤å¯¹è¯æ¡†"]
            CopyContent["å¤åˆ¶å†…å®¹<br/>â€¢ çº¯æ–‡æœ¬æ ¼å¼"]
            StopGeneration["åœæ­¢ç”Ÿæˆ<br/>â€¢ ä¸­æ–­æ™ºèƒ½ä½“"]
        end
        
        subgraph "è¾“å…¥æ§åˆ¶"
            AgentSelect["æ™ºèƒ½ä½“é€‰æ‹©<br/>â€¢ ä¸‹æ‹‰é€‰æ‹©<br/>â€¢ æ˜¾ç¤ºå¯ç”¨çŠ¶æ€"]
            NodeSelect["èŠ‚ç‚¹é€‰æ‹©<br/>â€¢ æ ¹æ®æ™ºèƒ½ä½“<br/>â€¢ åŠ¨æ€å€™é€‰åˆ—è¡¨"]
            InputArea["è¾“å…¥åŒºåŸŸ<br/>â€¢ å¤šè¡Œæ–‡æœ¬<br/>â€¢ å¿«æ·é”®æ”¯æŒ"]
            SendButton["å‘é€æŒ‰é’®<br/>â€¢ çŠ¶æ€æ§åˆ¶<br/>â€¢ åŠ è½½æŒ‡ç¤º"]
        end
        
        subgraph "çŠ¶æ€ç®¡ç†"
            MsgQueue["æ¶ˆæ¯é˜Ÿåˆ—<br/>â€¢ é¡ºåºç®¡ç†<br/>â€¢ çŠ¶æ€åŒæ­¥"]
            SSEConnection["SSEè¿æ¥<br/>â€¢ è‡ªåŠ¨é‡è¿<br/>â€¢ é”™è¯¯å¤„ç†"]
            UILocking["ç•Œé¢é”å®š<br/>â€¢ äº’æ–¥æ“ä½œ<br/>â€¢ çŠ¶æ€æŒ‡ç¤º"]
        end
    end
    
    UserMsg --> MsgHeader
    AgentMsg --> MsgHeader
    SystemMsg --> MsgHeader
    
    MsgHeader --> MsgTitle
    MsgTitle --> MsgContent
    MsgContent --> MsgThinking
    
    MsgHeader --> ViewSnapshot
    MsgHeader --> RollbackMsg
    MsgHeader --> CopyContent
    
    AgentSelect --> NodeSelect
    NodeSelect --> InputArea
    InputArea --> SendButton
    SendButton --> StopGeneration
    
    MsgQueue --> SSEConnection
    SSEConnection --> UILocking
```

#### æ¶ˆæ¯æ•°æ®ç»“æ„

```javascript
// æ¶ˆæ¯å¯¹è±¡ç»“æ„
{
  id: "message_id",
  role: "user" | "assistant" | "system",
  publisher: "node_id", // æ™ºèƒ½ä½“æ¶ˆæ¯çš„å‘å¸ƒè€…èŠ‚ç‚¹
  status: "generating" | "completed" | "failed",
  title: "æ¶ˆæ¯æ ‡é¢˜",
  thinking: "æ€è€ƒè¿‡ç¨‹", // å¯æŠ˜å ï¼Œé»˜è®¤æ”¶èµ·
  content: "æ¶ˆæ¯å†…å®¹", // å¯æŠ˜å ï¼Œé»˜è®¤å±•å¼€
  action_title: "æ“ä½œæ ‡é¢˜",
  action_params: {}, // æ“ä½œå‚æ•°
  snapshot_id: "å¿«ç…§ID",
  visible_node_ids: [], // å¯è§èŠ‚ç‚¹åˆ—è¡¨
  created_at: "åˆ›å»ºæ—¶é—´",
  updated_at: "æ›´æ–°æ—¶é—´"
}
```

#### SSE æµå¼æ•°æ®å¤„ç†

```javascript
// SSE æœåŠ¡
class SSEService {
  constructor() {
    this.eventSource = null;
    this.reconnectAttempts = 0;
    this.maxReconnectAttempts = 5;
  }
  
  // å»ºç«‹ SSE è¿æ¥
  connect(url) {
    this.eventSource = new EventSource(url);
    
    this.eventSource.onmessage = (event) => {
      const patch = JSON.parse(event.data);
      this.handlePatch(patch);
    };
    
    this.eventSource.onerror = () => {
      this.handleReconnect();
    };
  }
  
  // å¤„ç†è¡¥ä¸æ•°æ®
  handlePatch(patch) {
    const messageStore = useMessageStore();
    messageStore.applyPatch(patch);
  }
  
  // è‡ªåŠ¨é‡è¿æœºåˆ¶
  handleReconnect() {
    if (this.reconnectAttempts < this.maxReconnectAttempts) {
      setTimeout(() => {
        this.reconnectAttempts++;
        this.connect(this.lastUrl);
      }, Math.pow(2, this.reconnectAttempts) * 1000);
    }
  }
}
```

#### æ™ºèƒ½ä½“é€‰æ‹©é€»è¾‘

```javascript
// æ™ºèƒ½ä½“é…ç½®
const AGENT_CONFIGS = {
  auto_research_agent: {
    name: "è‡ªåŠ¨ç ”ç©¶æ™ºèƒ½ä½“",
    description: "ä¸ºå®æ–½é—®é¢˜è‡ªåŠ¨ç”Ÿæˆè§£å†³æ–¹æ¡ˆ",
    requiresNode: true,
    nodeType: "problem",
    nodeFilter: (node) => node.problem_type === "implementation"
  },
  user_chat_agent: {
    name: "ç”¨æˆ·å¯¹è¯æ™ºèƒ½ä½“",
    description: "ä¸è§£å†³æ–¹æ¡ˆè¿›è¡Œå¯¹è¯äº¤æµ",
    requiresNode: true,
    nodeType: "solution",
    nodeFilter: (node) => node.type === "solution"
  }
};
```

## çŠ¶æ€ç®¡ç†è®¾è®¡

### å…¨å±€çŠ¶æ€æ¶æ„

ä½¿ç”¨ Pinia è¿›è¡Œæ¨¡å—åŒ–çŠ¶æ€ç®¡ç†ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹ Storeï¼š

#### 1. é¡¹ç›®çŠ¶æ€ (projectStore)
```javascript
export const useProjectStore = defineStore('project', {
  state: () => ({
    currentProject: null,
    projectList: [],
    isLoading: false,
    lastSaveTime: null
  })
});
```

#### 2. ç ”ç©¶æ ‘çŠ¶æ€ (treeStore)
```javascript
export const useTreeStore = defineStore('tree', {
  state: () => ({
    currentSnapshot: null,
    mindElixirData: null,
    selectedNodeId: null,
    isViewingSnapshot: false,
    tempSnapshotId: null
  })
});
```

#### 3. æ¶ˆæ¯çŠ¶æ€ (messageStore)
```javascript
export const useMessageStore = defineStore('message', {
  state: () => ({
    messages: [],
    isGenerating: false,
    currentAgentName: null,
    sseConnection: null
  })
});
```

#### 4. UIçŠ¶æ€ (uiStore)
```javascript
export const useUIStore = defineStore('ui', {
  state: () => ({
    theme: 'light',
    language: 'zh-CN',
    leftPanelCollapsed: false,
    rightPanelCollapsed: false,
    isLoading: false,
    loadingText: ''
  })
});
```

### UIçŠ¶æ€ç®¡ç†å›¾

```mermaid
stateDiagram-v2
    [*] --> Idle: åº”ç”¨å¯åŠ¨
    
    state "ç©ºé—²çŠ¶æ€" as Idle {
        [*] --> Ready
        Ready --> ProjectLoading: åŠ è½½å·¥ç¨‹
        Ready --> TreeEditing: ç¼–è¾‘ç ”ç©¶æ ‘
        Ready --> AgentCalling: è°ƒç”¨æ™ºèƒ½ä½“
    }
    
    state "å·¥ç¨‹æ“ä½œä¸­" as ProjectLoading {
        [*] --> Loading
        Loading --> Success: æ“ä½œæˆåŠŸ
        Loading --> Error: æ“ä½œå¤±è´¥
        Success --> [*]
        Error --> [*]
    }
    
    state "æ ‘ç¼–è¾‘ä¸­" as TreeEditing {
        [*] --> Editing
        Editing --> Validating: éªŒè¯è¾“å…¥
        Validating --> Saving: ä¿å­˜æ›´æ”¹
        Validating --> Invalid: éªŒè¯å¤±è´¥
        Saving --> Success: ä¿å­˜æˆåŠŸ
        Saving --> Error: ä¿å­˜å¤±è´¥
        Invalid --> Editing: é‡æ–°ç¼–è¾‘
        Success --> [*]
        Error --> [*]
    }
    
    state "æ™ºèƒ½ä½“å·¥ä½œä¸­" as AgentCalling {
        [*] --> Connecting: å»ºç«‹SSEè¿æ¥
        Connecting --> Streaming: æ¥æ”¶æµå¼æ•°æ®
        Connecting --> ConnectionError: è¿æ¥å¤±è´¥
        Streaming --> Processing: å¤„ç†æ¶ˆæ¯
        Processing --> Streaming: ç»§ç»­æ¥æ”¶
        Processing --> Completed: ç”Ÿæˆå®Œæˆ
        Processing --> Interrupted: ç”¨æˆ·ä¸­æ–­
        Processing --> AgentError: æ™ºèƒ½ä½“é”™è¯¯
        Completed --> [*]
        Interrupted --> [*]
        AgentError --> [*]
        ConnectionError --> [*]
    }
    
    ProjectLoading --> Idle: æ“ä½œå®Œæˆ
    TreeEditing --> Idle: ç¼–è¾‘å®Œæˆ
    AgentCalling --> Idle: æ™ºèƒ½ä½“å®Œæˆ
    
    note right of AgentCalling
        æ™ºèƒ½ä½“å·¥ä½œæ—¶ï¼š
        â€¢ ç¦ç”¨æ‰€æœ‰æ ‘æ“ä½œ
        â€¢ ç¦ç”¨å·¥ç¨‹åˆ‡æ¢
        â€¢ ç¦ç”¨å…¶ä»–æ™ºèƒ½ä½“è°ƒç”¨
        â€¢ åªå…è®¸åœæ­¢æ“ä½œ
    end note
    
    note right of TreeEditing
        æ ‘ç¼–è¾‘æ—¶ï¼š
        â€¢ ç¦ç”¨æ™ºèƒ½ä½“è°ƒç”¨
        â€¢ ç¦ç”¨å·¥ç¨‹åˆ‡æ¢
        â€¢ å…è®¸å–æ¶ˆç¼–è¾‘
    end note
```

### çŠ¶æ€äº’æ–¥æ§åˆ¶

ä¸ºç¡®ä¿æ“ä½œçš„äº’æ–¥æ€§ï¼Œå®ç°å…¨å±€çŠ¶æ€é”æœºåˆ¶ï¼š

```javascript
// çŠ¶æ€é”ç®¡ç†å™¨
class StateLockManager {
  constructor() {
    this.locks = new Set();
  }
  
  // è·å–é”
  acquireLock(lockName) {
    if (this.locks.has(lockName)) {
      throw new Error(`æ“ä½œå†²çªï¼š${lockName} æ­£åœ¨è¿›è¡Œä¸­`);
    }
    this.locks.add(lockName);
  }
  
  // é‡Šæ”¾é”
  releaseLock(lockName) {
    this.locks.delete(lockName);
  }
  
  // æ£€æŸ¥é”çŠ¶æ€
  isLocked(lockName) {
    return this.locks.has(lockName);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const lockManager = new StateLockManager();

// æ™ºèƒ½ä½“å·¥ä½œæ—¶çš„çŠ¶æ€æ§åˆ¶
if (lockManager.isLocked('agent_working')) {
  // ç¦ç”¨å·¥ç¨‹åˆ‡æ¢
  // ç¦ç”¨å…¶ä»–æ™ºèƒ½ä½“è°ƒç”¨
  // æ˜¾ç¤ºæ™ºèƒ½ä½“æ“ä½œçŠ¶æ€
}

// å¿«ç…§æŸ¥çœ‹æ—¶çš„çŠ¶æ€æ§åˆ¶
if (lockManager.isLocked('snapshot_viewing')) {
  // æ˜¾ç¤ºä¸´æ—¶çŠ¶æ€æç¤º
  // ç¦ç”¨éƒ¨åˆ†æ“ä½œ
}
```

> âš ï¸ **æ³¨æ„**ï¼šç ”ç©¶æ ‘ç¼–è¾‘ç›¸å…³çš„é”æ§åˆ¶ï¼ˆå¦‚ `tree_editing`ï¼‰å±äºåç»­ç‰ˆæœ¬åŠŸèƒ½ï¼Œå½“å‰é˜¶æ®µæš‚ä¸å®ç°ã€‚

## ç”¨æˆ·ç•Œé¢è®¾è®¡

### æ•´ä½“å¸ƒå±€

é‡‡ç”¨ç»å…¸çš„ä¸‰æ å¸ƒå±€è®¾è®¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åº”ç”¨å¤´éƒ¨                              â”‚
â”‚  é¡¹ç›®æ ‡é¢˜ | å·¥ç¨‹ç®¡ç† | è¯­è¨€åˆ‡æ¢ | ä¸»é¢˜åˆ‡æ¢                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚                         â”‚                     â”‚
â”‚   å·¦ä¾§é¢æ¿   â”‚        ä¸­å¤®é¢æ¿          â”‚      å³ä¾§é¢æ¿        â”‚
â”‚             â”‚                         â”‚                     â”‚
â”‚  å·¥ç¨‹ç®¡ç†    â”‚      ç ”ç©¶æ ‘å¯è§†åŒ–        â”‚    æ¶ˆæ¯åˆ—è¡¨å¯¹è¯      â”‚
â”‚             â”‚                         â”‚                     â”‚
â”‚  â€¢ å½“å‰å·¥ç¨‹  â”‚  â€¢ æ€ç»´å¯¼å›¾ç”»å¸ƒ          â”‚  â€¢ æ™ºèƒ½ä½“é€‰æ‹©        â”‚
â”‚  â€¢ å·¥ç¨‹åˆ—è¡¨  â”‚  â€¢ å·¥å…·æ                â”‚  â€¢ æ¶ˆæ¯åˆ—è¡¨          â”‚
â”‚  â€¢ æ“ä½œæŒ‰é’®  â”‚  â€¢ èŠ‚ç‚¹ç¼–è¾‘é¢æ¿          â”‚  â€¢ è¾“å…¥æ¡†            â”‚
â”‚             â”‚                         â”‚                     â”‚
â”‚   300px     â”‚        è‡ªé€‚åº”            â”‚       400px         â”‚
â”‚  å¯æŠ˜å       â”‚      æœ€å°600px          â”‚      å¯æŠ˜å           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å“åº”å¼è®¾è®¡

#### æ¡Œé¢ç«¯ (â‰¥1200px)
- ä¸‰æ å¸ƒå±€ï¼Œæ‰€æœ‰åŠŸèƒ½å®Œæ•´å±•ç¤º
- ä¾§è¾¹æ å¯æŠ˜å ï¼ŒèŠ‚çœç©ºé—´
- æ”¯æŒå¿«æ·é”®æ“ä½œ

#### å¹³æ¿ç«¯ (768px-1199px)
- ä¸¤æ å¸ƒå±€ï¼Œå·¦ä¾§é¢æ¿æ”¹ä¸ºæŠ½å±‰å¼
- ä¸­å¤®é¢æ¿å’Œå³ä¾§é¢æ¿å¹¶æ’æ˜¾ç¤º
- è§¦æ‘¸å‹å¥½çš„äº¤äº’è®¾è®¡

#### ç§»åŠ¨ç«¯ (<768px)
- å•æ å¸ƒå±€ï¼Œä½¿ç”¨æ ‡ç­¾é¡µåˆ‡æ¢
- åº•éƒ¨å¯¼èˆªæ ï¼Œå¿«é€Ÿåˆ‡æ¢åŠŸèƒ½æ¨¡å—
- ä¼˜åŒ–è§¦æ‘¸æ“ä½œä½“éªŒ

### è§†è§‰è®¾è®¡è§„èŒƒå›¾

```mermaid
graph TB
    subgraph "è§†è§‰è®¾è®¡è§„èŒƒ"
        subgraph "ä¸»é¢˜ç³»ç»Ÿ"
            LightTheme["äº®è‰²ä¸»é¢˜<br/>â€¢ èƒŒæ™¯ï¼š#ffffff<br/>â€¢ æ–‡å­—ï¼š#303133<br/>â€¢ è¾¹æ¡†ï¼š#dcdfe6<br/>â€¢ é˜´å½±ï¼šrgba(0,0,0,0.1)"]
            DarkTheme["æš—è‰²ä¸»é¢˜<br/>â€¢ èƒŒæ™¯ï¼š#1a1a1a<br/>â€¢ æ–‡å­—ï¼š#e4e7ed<br/>â€¢ è¾¹æ¡†ï¼š#4c4d4f<br/>â€¢ é˜´å½±ï¼šrgba(0,0,0,0.3)"]
        end
        
        subgraph "èŠ‚ç‚¹æ ·å¼"
            ProblemNodeStyle["é—®é¢˜èŠ‚ç‚¹<br/>â€¢ å®æ–½é—®é¢˜ï¼š#409effï¼ˆè“è‰²ï¼‰<br/>â€¢ æ¡ä»¶é—®é¢˜ï¼š#e6a23cï¼ˆæ©™è‰²ï¼‰<br/>â€¢ åœ†è§’çŸ©å½¢<br/>â€¢ é˜´å½±æ•ˆæœ"]
            SolutionNodeStyle["è§£å†³æ–¹æ¡ˆèŠ‚ç‚¹<br/>â€¢ è¿›è¡Œä¸­ï¼š#e6a23cï¼ˆé»„è‰²ï¼‰<br/>â€¢ æˆåŠŸï¼š#67c23aï¼ˆç»¿è‰²ï¼‰<br/>â€¢ å¤±è´¥ï¼š#f56c6cï¼ˆçº¢è‰²ï¼‰<br/>â€¢ é€‰ä¸­ï¼šåŠ ç²—è¾¹æ¡†"]
        end
        
        subgraph "æ¶ˆæ¯æ ·å¼"
            UserMsgStyle["ç”¨æˆ·æ¶ˆæ¯<br/>â€¢ å³å¯¹é½<br/>â€¢ è“è‰²æ°”æ³¡<br/>â€¢ ç™½è‰²æ–‡å­—<br/>â€¢ åœ†è§’è®¾è®¡"]
            AgentMsgStyle["æ™ºèƒ½ä½“æ¶ˆæ¯<br/>â€¢ å·¦å¯¹é½<br/>â€¢ ç°è‰²æ°”æ³¡<br/>â€¢ æ·±è‰²æ–‡å­—<br/>â€¢ ä¸“å®¶å¤´åƒ"]
            SystemMsgStyle["ç³»ç»Ÿæ¶ˆæ¯<br/>â€¢ å±…ä¸­æ˜¾ç¤º<br/>â€¢ æ·¡ç°èƒŒæ™¯<br/>â€¢ å°å­—ä½“<br/>â€¢ è™šçº¿è¾¹æ¡†"]
        end
        
        subgraph "äº¤äº’çŠ¶æ€"
            HoverState["æ‚¬åœçŠ¶æ€<br/>â€¢ è½»å¾®æ”¾å¤§<br/>â€¢ é˜´å½±åŠ æ·±<br/>â€¢ é¢œè‰²å˜äº®<br/>â€¢ è¿‡æ¸¡åŠ¨ç”»"]
            ActiveState["æ¿€æ´»çŠ¶æ€<br/>â€¢ è¾¹æ¡†é«˜äº®<br/>â€¢ èƒŒæ™¯å˜åŒ–<br/>â€¢ å›¾æ ‡å˜åŒ–<br/>â€¢ åé¦ˆåŠ¨ç”»"]
            DisabledState["ç¦ç”¨çŠ¶æ€<br/>â€¢ é€æ˜åº¦50%<br/>â€¢ é¼ æ ‡ç¦ç”¨<br/>â€¢ ç°è‰²è°ƒ<br/>â€¢ ç¦ç”¨å›¾æ ‡"]
        end
        
        subgraph "åŠ¨ç”»æ•ˆæœ"
            LoadingAnimation["åŠ è½½åŠ¨ç”»<br/>â€¢ æ—‹è½¬å›¾æ ‡<br/>â€¢ è„‰å†²æ•ˆæœ<br/>â€¢ è¿›åº¦æ¡<br/>â€¢ éª¨æ¶å±"]
            TransitionAnimation["è¿‡æ¸¡åŠ¨ç”»<br/>â€¢ æ·¡å…¥æ·¡å‡º<br/>â€¢ æ»‘åŠ¨æ•ˆæœ<br/>â€¢ ç¼©æ”¾å˜åŒ–<br/>â€¢ å¼¹æ€§åŠ¨ç”»"]
        end
        
        subgraph "å“åº”å¼è®¾è®¡"
            DesktopLayout["æ¡Œé¢å¸ƒå±€<br/>â€¢ ä¸‰æ å¸ƒå±€<br/>â€¢ æœ€å°å®½åº¦1200px<br/>â€¢ ä¾§è¾¹æ å¯æŠ˜å "]
            TabletLayout["å¹³æ¿å¸ƒå±€<br/>â€¢ ä¸¤æ å¸ƒå±€<br/>â€¢ 768px-1199px<br/>â€¢ æŠ½å±‰å¼ä¾§è¾¹æ "]
            MobileLayout["ç§»åŠ¨å¸ƒå±€<br/>â€¢ å•æ å¸ƒå±€<br/>â€¢ å°äº768px<br/>â€¢ æ ‡ç­¾é¡µåˆ‡æ¢"]
        end
    end
    
    LightTheme --> ProblemNodeStyle
    DarkTheme --> ProblemNodeStyle
    
    ProblemNodeStyle --> HoverState
    SolutionNodeStyle --> HoverState
    
    UserMsgStyle --> ActiveState
    AgentMsgStyle --> ActiveState
    SystemMsgStyle --> DisabledState
    
    HoverState --> LoadingAnimation
    ActiveState --> TransitionAnimation
    
    DesktopLayout --> TabletLayout
    TabletLayout --> MobileLayout
```

### ä¸»é¢˜è®¾è®¡

#### äº®è‰²ä¸»é¢˜
```css
:root {
  --bg-color: #ffffff;
  --text-color: #303133;
  --border-color: #dcdfe6;
  --shadow-color: rgba(0, 0, 0, 0.1);
  --primary-color: #409eff;
  --success-color: #67c23a;
  --warning-color: #e6a23c;
  --danger-color: #f56c6c;
}
```

#### æš—è‰²ä¸»é¢˜
```css
:root[data-theme="dark"] {
  --bg-color: #1a1a1a;
  --text-color: #e4e7ed;
  --border-color: #4c4d4f;
  --shadow-color: rgba(0, 0, 0, 0.3);
  --primary-color: #409eff;
  --success-color: #67c23a;
  --warning-color: #e6a23c;
  --danger-color: #f56c6c;
}
```

## äº¤äº’æµç¨‹è®¾è®¡

### æ™ºèƒ½ä½“è°ƒç”¨æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant UI as å‰ç«¯ç•Œé¢
    participant Store as çŠ¶æ€ç®¡ç†
    participant API as APIæœåŠ¡
    participant SSE as SSEæœåŠ¡
    participant Backend as åç«¯æœåŠ¡
    
    Note over User,Backend: æ™ºèƒ½ä½“è°ƒç”¨æµç¨‹
    
    User->>UI: é€‰æ‹©æ™ºèƒ½ä½“å¹¶è¾“å…¥æ¶ˆæ¯
    UI->>Store: éªŒè¯è¾“å…¥å¹¶æ›´æ–°UIçŠ¶æ€
    Store->>API: å‘é€æ™ºèƒ½ä½“è°ƒç”¨è¯·æ±‚
    API->>Backend: POST /agents/messages
    
    Backend-->>SSE: å»ºç«‹SSEè¿æ¥
    SSE-->>Store: å¼€å§‹æ¥æ”¶æµå¼æ•°æ®
    
    loop æµå¼æ•°æ®æ¥æ”¶
        Backend->>SSE: å‘é€patchäº‹ä»¶
        SSE->>Store: æ›´æ–°æ¶ˆæ¯çŠ¶æ€
        Store->>UI: è§¦å‘ç•Œé¢æ›´æ–°
        UI->>User: å®æ—¶æ˜¾ç¤ºç”Ÿæˆå†…å®¹
    end
    
    Backend->>SSE: å‘é€finishedäº‹ä»¶
    SSE->>Store: æ ‡è®°æ¶ˆæ¯å®Œæˆ
    Store->>UI: æ›´æ–°å®ŒæˆçŠ¶æ€
    
    alt åŒ…å«æ•°æ®åº“æ“ä½œ
        Store->>Store: æ›´æ–°ç ”ç©¶æ ‘çŠ¶æ€
        Store->>UI: åˆ·æ–°æ ‘å½¢è§†å›¾
    end
    
    UI->>User: æ˜¾ç¤ºæœ€ç»ˆç»“æœ
```

### ç ”ç©¶æ ‘äº¤äº’æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant TreeUI as ç ”ç©¶æ ‘ç•Œé¢
    participant MindElixir as æ€ç»´å¯¼å›¾ç»„ä»¶
    participant Store as æ ‘çŠ¶æ€ç®¡ç†
    participant Transformer as æ•°æ®è½¬æ¢å™¨
    participant API as åç«¯API
    
    Note over User,API: ç ”ç©¶æ ‘äº¤äº’æµç¨‹
    
    User->>TreeUI: ç‚¹å‡»èŠ‚ç‚¹
    TreeUI->>MindElixir: è·å–é€‰ä¸­èŠ‚ç‚¹
    MindElixir->>Store: æ›´æ–°é€‰ä¸­çŠ¶æ€
    Store->>TreeUI: æ˜¾ç¤ºèŠ‚ç‚¹è¯¦æƒ…é¢æ¿
    
    User->>TreeUI: ç¼–è¾‘èŠ‚ç‚¹å†…å®¹
    TreeUI->>Store: éªŒè¯ç¼–è¾‘æƒé™
    
    alt å…è®¸ç¼–è¾‘
        Store->>Transformer: è½¬æ¢ä¸ºåç«¯æ ¼å¼
        Transformer->>API: å‘é€æ›´æ–°è¯·æ±‚
        API->>Store: è¿”å›æ–°å¿«ç…§
        Store->>Transformer: è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼
        Transformer->>MindElixir: æ›´æ–°æ€ç»´å¯¼å›¾
        MindElixir->>TreeUI: é‡æ–°æ¸²æŸ“
    else ç¦æ­¢ç¼–è¾‘
        Store->>TreeUI: æ˜¾ç¤ºé”™è¯¯æç¤º
    end
    
    Note over User,API: å¿«ç…§æŸ¥çœ‹æµç¨‹
    
    User->>TreeUI: ç‚¹å‡»æŸ¥çœ‹å¿«ç…§
    TreeUI->>Store: è¯·æ±‚å†å²å¿«ç…§
    Store->>API: è·å–å¿«ç…§æ•°æ®
    API->>Store: è¿”å›å¿«ç…§å†…å®¹
    Store->>Transformer: è½¬æ¢æ•°æ®æ ¼å¼
    Transformer->>MindElixir: ä¸´æ—¶æ˜¾ç¤ºå¿«ç…§
    MindElixir->>TreeUI: æ˜¾ç¤ºä¸´æ—¶æ ‡è¯†
    
    User->>TreeUI: é€€å‡ºå¿«ç…§æŸ¥çœ‹
    TreeUI->>Store: æ¢å¤å½“å‰çŠ¶æ€
    Store->>MindElixir: æ¢å¤æ­£å¸¸æ˜¾ç¤º
```

### æ™ºèƒ½ä½“è°ƒç”¨æµç¨‹

1. **å‡†å¤‡é˜¶æ®µ**
   - ç”¨æˆ·é€‰æ‹©æ™ºèƒ½ä½“ç±»å‹
   - æ ¹æ®æ™ºèƒ½ä½“è¦æ±‚é€‰æ‹©ç›®æ ‡èŠ‚ç‚¹
   - è¾“å…¥è°ƒç”¨å†…å®¹

2. **è°ƒç”¨é˜¶æ®µ**
   - å‘é€ POST è¯·æ±‚åˆ° `/agents/messages`
   - å»ºç«‹ SSE è¿æ¥æ¥æ”¶æµå¼æ•°æ®
   - å®æ—¶æ›´æ–°æ¶ˆæ¯å†…å®¹

3. **å¤„ç†é˜¶æ®µ**
   - æ¥æ”¶ patch äº‹ä»¶æ›´æ–°æ¶ˆæ¯
   - å¤„ç†æ•°æ®åº“æ“ä½œç»“æœ
   - æ›´æ–°ç ”ç©¶æ ‘çŠ¶æ€

4. **å®Œæˆé˜¶æ®µ**
   - æ¥æ”¶ finished äº‹ä»¶
   - é‡Šæ”¾ç•Œé¢é”å®š
   - æ˜¾ç¤ºæœ€ç»ˆç»“æœ

### ç ”ç©¶æ ‘ç¼–è¾‘æµç¨‹ï¼ˆæš‚ä¸å®ç°ï¼‰

> âš ï¸ **æ³¨æ„**ï¼šä»¥ä¸‹ç¼–è¾‘æµç¨‹å±äºåç»­ç‰ˆæœ¬åŠŸèƒ½ï¼Œå½“å‰é˜¶æ®µæš‚ä¸å®ç°ã€‚

1. **é€‰æ‹©èŠ‚ç‚¹**ï¼ˆé¢„ç•™ï¼‰
   - ç‚¹å‡»æ€ç»´å¯¼å›¾èŠ‚ç‚¹
   - æ˜¾ç¤ºèŠ‚ç‚¹è¯¦æƒ…é¢æ¿
   - æ£€æŸ¥ç¼–è¾‘æƒé™

2. **ç¼–è¾‘æ“ä½œ**ï¼ˆé¢„ç•™ï¼‰
   - ä¿®æ”¹èŠ‚ç‚¹å†…å®¹
   - éªŒè¯è¾“å…¥åˆæ³•æ€§
   - æ£€æŸ¥çº¦æŸæ¡ä»¶

3. **ä¿å­˜æ›´æ”¹**ï¼ˆé¢„ç•™ï¼‰
   - å‘é€æ›´æ–°è¯·æ±‚
   - æ¥æ”¶æ–°å¿«ç…§æ•°æ®
   - æ›´æ–°æ€ç»´å¯¼å›¾æ˜¾ç¤º

4. **é”™è¯¯å¤„ç†**ï¼ˆé¢„ç•™ï¼‰
   - æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
   - å›æ»šåˆ°åŸå§‹çŠ¶æ€
   - æä¾›é‡è¯•é€‰é¡¹

### å¿«ç…§æŸ¥çœ‹æµç¨‹

1. **è§¦å‘æŸ¥çœ‹**
   - ç‚¹å‡»æ¶ˆæ¯çš„"æŸ¥çœ‹å¿«ç…§"æŒ‰é’®
   - è·å–å¿«ç…§ID

2. **ä¸´æ—¶æ˜¾ç¤º**
   - è¯·æ±‚å¿«ç…§æ•°æ®
   - è½¬æ¢ä¸ºæ€ç»´å¯¼å›¾æ ¼å¼
   - ä¸´æ—¶æ›¿æ¢å½“å‰æ˜¾ç¤º

3. **çŠ¶æ€æç¤º**
   - æ˜¾ç¤º"æ­£åœ¨æŸ¥çœ‹å†å²å¿«ç…§"æç¤º
   - æä¾›è¿”å›å½“å‰çŠ¶æ€æŒ‰é’®
   - åº”ç”¨ä¸´æ—¶çŠ¶æ€æ ·å¼å±‚

4. **é€€å‡ºæŸ¥çœ‹**
   - æ¢å¤å½“å‰å¿«ç…§æ˜¾ç¤º
   - ç§»é™¤ä¸´æ—¶çŠ¶æ€æç¤º
   - æ¢å¤æ­£å¸¸æ˜¾ç¤ºæ ·å¼

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. ç»„ä»¶æ‡’åŠ è½½
```javascript
// è·¯ç”±çº§åˆ«çš„æ‡’åŠ è½½
const routes = [
  {
    path: '/project',
    component: () => import('@/views/ProjectView.vue')
  }
];

// ç»„ä»¶çº§åˆ«çš„æ‡’åŠ è½½
const NodeEditor = defineAsyncComponent(() => 
  import('@/components/NodeEditor.vue')
);
```

### 2. è™šæ‹Ÿæ»šåŠ¨
```javascript
// æ¶ˆæ¯åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
<virtual-list
  :data-sources="messages"
  :data-key="'id'"
  :keeps="30"
  :estimate-size="100"
>
  <template #item="{ record }">
    <MessageItem :message="record" />
  </template>
</virtual-list>
```

### 3. é˜²æŠ–å’ŒèŠ‚æµ
```javascript
// æœç´¢è¾“å…¥é˜²æŠ–
const debouncedSearch = debounce((query) => {
  searchProjects(query);
}, 300);

// æ»šåŠ¨äº‹ä»¶èŠ‚æµ
const throttledScroll = throttle((event) => {
  handleScroll(event);
}, 100);
```

### 4. ç¼“å­˜ç­–ç•¥
```javascript
// API å“åº”ç¼“å­˜
const apiCache = new Map();

async function cachedRequest(url, options = {}) {
  const cacheKey = `${url}_${JSON.stringify(options)}`;
  
  if (apiCache.has(cacheKey)) {
    return apiCache.get(cacheKey);
  }
  
  const response = await fetch(url, options);
  const data = await response.json();
  
  apiCache.set(cacheKey, data);
  return data;
}
```

## é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ

### 1. å…¨å±€é”™è¯¯å¤„ç†
```javascript
// å…¨å±€é”™è¯¯å¤„ç†å™¨
app.config.errorHandler = (err, vm, info) => {
  console.error('å…¨å±€é”™è¯¯:', err);
  
  // æ˜¾ç¤ºç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
  ElMessage.error('æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
  
  // å‘é€é”™è¯¯æŠ¥å‘Šï¼ˆå¯é€‰ï¼‰
  reportError(err, vm, info);
};
```

### 2. API é”™è¯¯å¤„ç†
```javascript
// HTTP æ‹¦æˆªå™¨
axios.interceptors.response.use(
  response => response,
  error => {
    const { status, data } = error.response || {};
    
    switch (status) {
      case 400:
        ElMessage.error(data.detail || 'è¯·æ±‚å‚æ•°é”™è¯¯');
        break;
      case 401:
        ElMessage.error('æœªæˆæƒè®¿é—®');
        break;
      case 404:
        ElMessage.error('è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨');
        break;
      case 500:
        ElMessage.error('æœåŠ¡å™¨å†…éƒ¨é”™è¯¯');
        break;
      default:
        ElMessage.error('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥è¿æ¥');
    }
    
    return Promise.reject(error);
  }
);
```

### 3. ç”¨æˆ·åé¦ˆæœºåˆ¶
```javascript
// æ“ä½œæˆåŠŸåé¦ˆ
const showSuccess = (message) => {
  ElMessage.success(message);
};

// æ“ä½œç¡®è®¤å¯¹è¯æ¡†
const confirmAction = async (message, title = 'ç¡®è®¤æ“ä½œ') => {
  try {
    await ElMessageBox.confirm(message, title, {
      confirmButtonText: 'ç¡®å®š',
      cancelButtonText: 'å–æ¶ˆ',
      type: 'warning'
    });
    return true;
  } catch {
    return false;
  }
};

// åŠ è½½çŠ¶æ€æŒ‡ç¤º
const showLoading = (text = 'åŠ è½½ä¸­...') => {
  return ElLoading.service({
    lock: true,
    text,
    background: 'rgba(0, 0, 0, 0.7)'
  });
};
```

## å›½é™…åŒ–è®¾è®¡

### 1. è¯­è¨€é…ç½®
```javascript
// i18n é…ç½®
const messages = {
  'zh-CN': {
    app: {
      title: 'ResVizCopilot 2.0',
      loading: 'åŠ è½½ä¸­...',
      save: 'ä¿å­˜',
      cancel: 'å–æ¶ˆ'
    },
    project: {
      create: 'åˆ›å»ºå·¥ç¨‹',
      save: 'ä¿å­˜å·¥ç¨‹',
      load: 'åŠ è½½å·¥ç¨‹'
    },
    tree: {
      problem: 'é—®é¢˜',
      solution: 'è§£å†³æ–¹æ¡ˆ',
      edit: 'ç¼–è¾‘èŠ‚ç‚¹'
    },
    message: {
      user: 'ç”¨æˆ·',
      agent: 'æ™ºèƒ½ä½“',
      system: 'ç³»ç»Ÿ'
    }
  },
  'en-US': {
    app: {
      title: 'ResVizCopilot 2.0',
      loading: 'Loading...',
      save: 'Save',
      cancel: 'Cancel'
    },
    project: {
      create: 'Create Project',
      save: 'Save Project',
      load: 'Load Project'
    },
    tree: {
      problem: 'Problem',
      solution: 'Solution',
      edit: 'Edit Node'
    },
    message: {
      user: 'User',
      agent: 'Agent',
      system: 'System'
    }
  }
};
```

### 2. åŠ¨æ€è¯­è¨€åˆ‡æ¢
```javascript
// è¯­è¨€åˆ‡æ¢ç»„ä»¶
const LanguageSelector = {
  setup() {
    const { locale } = useI18n();
    
    const changeLanguage = (lang) => {
      locale.value = lang;
      localStorage.setItem('language', lang);
    };
    
    return { locale, changeLanguage };
  }
};
```

## æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•
```javascript
// ç»„ä»¶æµ‹è¯•ç¤ºä¾‹
import { mount } from '@vue/test-utils';
import MessageItem from '@/components/MessageItem.vue';

describe('MessageItem', () => {
  it('should render user message correctly', () => {
    const wrapper = mount(MessageItem, {
      props: {
        message: {
          id: '1',
          role: 'user',
          title: 'æµ‹è¯•æ¶ˆæ¯',
          content: 'è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯'
        }
      }
    });
    
    expect(wrapper.find('.message-title').text()).toBe('æµ‹è¯•æ¶ˆæ¯');
    expect(wrapper.find('.message-content').text()).toBe('è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯');
  });
});
```

### 2. é›†æˆæµ‹è¯•
```javascript
// API é›†æˆæµ‹è¯•
describe('Project API', () => {
  it('should create project successfully', async () => {
    const projectStore = useProjectStore();
    const result = await projectStore.createProject('æµ‹è¯•å·¥ç¨‹');
    
    expect(result.success).toBe(true);
    expect(projectStore.currentProject.name).toBe('æµ‹è¯•å·¥ç¨‹');
  });
});
```

### 3. E2E æµ‹è¯•
```javascript
// Cypress E2E æµ‹è¯•
describe('Research Tree Interaction', () => {
  it('should allow user to edit node', () => {
    cy.visit('/');
    cy.get('[data-testid="tree-node"]').first().click();
    cy.get('[data-testid="node-editor"]').should('be.visible');
    cy.get('[data-testid="node-title-input"]').clear().type('æ–°æ ‡é¢˜');
    cy.get('[data-testid="save-button"]').click();
    cy.get('[data-testid="tree-node"]').should('contain', 'æ–°æ ‡é¢˜');
  });
});
```

## éƒ¨ç½²å’Œæ„å»º

### 1. æ„å»ºé…ç½®
```javascript
// vue.config.js
module.exports = {
  outputDir: 'dist',
  assetsDir: 'assets',
  productionSourceMap: false,
  
  configureWebpack: {
    optimization: {
      splitChunks: {
        chunks: 'all',
        cacheGroups: {
          vendor: {
            name: 'vendor',
            test: /[\\/]node_modules[\\/](vue|vue-router|pinia)[\\/]/,
            chunks: 'all'
          },
          ui: {
            name: 'ui',
            test: /[\\/]node_modules[\\/]element-plus[\\/]/,
            chunks: 'all'
          },
          utils: {
            name: 'utils',
            test: /[\\/]node_modules[\\/](axios|lodash)[\\/]/,
            chunks: 'all'
          }
        }
      }
    }
  }
};
```

### 2. ç¯å¢ƒé…ç½®
```javascript
// .env.production
VUE_APP_API_BASE_URL=https://api.resvizcopilot.com
VUE_APP_SSE_BASE_URL=https://sse.resvizcopilot.com
VUE_APP_TITLE=ResVizCopilot 2.0

// .env.development
VUE_APP_API_BASE_URL=http://localhost:8008
VUE_APP_SSE_BASE_URL=http://localhost:8008
VUE_APP_TITLE=ResVizCopilot 2.0 (Dev)
```

### 3. Docker éƒ¨ç½²
```dockerfile
# Dockerfile
FROM node:18-alpine as builder

WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

## å¼€å‘ç»éªŒæ€»ç»“

### ğŸš¨ å…³é”®ç»éªŒæ•™è®­

#### 1. APIæ¥å£å¯¹æ¥çš„æ•™è®­
**é—®é¢˜**ï¼šåŸè®¾è®¡æ–‡æ¡£ä¸­çš„APIæ¥å£æ ¼å¼ä¸åç«¯å®é™…å®ç°ä¸ç¬¦
- è®¾è®¡å‡è®¾ï¼š`POST /projects` + bodyå‚æ•°
- å®é™…å®ç°ï¼š`POST /projects?project_name={name}` + queryå‚æ•°

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… åœ¨å‰ç«¯å¼€å‘å‰ï¼Œå¿…é¡»å…ˆæŸ¥çœ‹åç«¯å®é™…ä»£ç 
- âœ… å»ºç«‹å‰åç«¯æ¥å£æ–‡æ¡£çš„åŒå‘éªŒè¯æœºåˆ¶
- âœ… åœ¨projectStoreä¸­æ·»åŠ æ•°æ®è½¬æ¢å±‚å¤„ç†å­—æ®µå·®å¼‚

#### 1.5. APIå°è£…å±‚ç†è§£é”™è¯¯çš„æ•™è®­ï¼ˆæ–°å¢ï¼‰
**é—®é¢˜**ï¼šè¯¯è®¤ä¸º `apiService` è¿”å›å®Œæ•´çš„ `response` å¯¹è±¡
- é”™è¯¯å‡è®¾ï¼š`response.data.success` 
- å®é™…æƒ…å†µï¼š`apiService` å·²ç»è¿”å›äº† `response.data`ï¼Œåº”è¯¥ç›´æ¥è®¿é—® `response.success`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… **å…³é”®**ï¼šä»»ä½•å°è£…å±‚éƒ½è¦æŸ¥çœ‹å®é™…å®ç°ï¼Œä¸èƒ½åŸºäºå‡è®¾ç¼–ç¨‹
- âœ… åœ¨ä½¿ç”¨å°è£…APIå‰ï¼Œå…ˆæŸ¥çœ‹å…¶è¿”å›å€¼ç»“æ„
- âœ… å»ºç«‹APIå“åº”æ ¼å¼çš„æ˜ç¡®æ–‡æ¡£

#### 2. Vue 3 + Pinia + Vue I18né›†æˆçš„æ•™è®­
**é—®é¢˜**ï¼šåˆå§‹åŒ–é¡ºåºé”™è¯¯å¯¼è‡´çŠ¶æ€æŒä¹…åŒ–å¤±æ•ˆ
```javascript
// âŒ é”™è¯¯åšæ³•
i18n.global.locale.value = uiStore.language  // é”™è¯¯åœ°ç»™å­—ç¬¦ä¸²èµ‹å€¼

// âœ… æ­£ç¡®åšæ³•
const uiStore = useUIStore()
const i18n = createI18n({
  locale: uiStore.language || 'zh-CN',  // åœ¨åˆ›å»ºæ—¶ä½¿ç”¨ä¿å­˜çš„è¯­è¨€
  fallbackLocale: 'en-US',
  messages
})
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… Piniaè¦åœ¨åˆ›å»ºi18nä¹‹å‰åˆå§‹åŒ–
- âœ… å›½é™…åŒ–é…ç½®è¦ç‹¬ç«‹åˆ°å•ç‹¬æ–‡ä»¶ `/src/locales/index.js`
- âœ… çŠ¶æ€æ¢å¤è¦åœ¨åº”ç”¨mountåè°ƒç”¨ `uiStore.initializeUI()`

#### 3. ç¬¬ä¸‰æ–¹ä¾èµ–éªŒè¯çš„æ•™è®­
**é—®é¢˜**ï¼šä½¿ç”¨äº†Element Plusä¸­ä¸å­˜åœ¨çš„å›¾æ ‡`Globe`
**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… ä½¿ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹åº“APIå‰å¿…é¡»æŸ¥é˜…å®˜æ–¹æ–‡æ¡£
- âœ… å»ºç«‹ä¾èµ–éªŒè¯æ¸…å•ï¼Œç¡®ä¿æ‰€æœ‰å¼•ç”¨çš„èµ„æºå­˜åœ¨

#### 4. æ•°æ®ç»“æ„æ˜ å°„çš„æ•™è®­
**é—®é¢˜**ï¼šåç«¯å­—æ®µå(`project_name`)ä¸å‰ç«¯æœŸæœ›(`name`)ä¸ä¸€è‡´
**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… åœ¨storeä¸­æ·»åŠ æ•°æ®è½¬æ¢é€»è¾‘
- âœ… åœ¨è®¾è®¡æ–‡æ¡£ä¸­æ˜ç¡®å®šä¹‰æ•°æ®ç»“æ„æ˜ å°„å…³ç³»

#### 5. Vueæ¨¡æ¿è¯­æ³•é”™è¯¯çš„æ•™è®­ï¼ˆæ–°å¢ï¼‰
**é—®é¢˜**ï¼šåœ¨åŒä¸€å…ƒç´ ä¸Šä½¿ç”¨ `v-for` å’Œ `v-if` å¯¼è‡´æ¸²æŸ“é”™è¯¯
```vue
<!-- âŒ é”™è¯¯ï¼šå¯¼è‡´"Property 'project' was accessed during render but is not defined"è­¦å‘Š -->
<div v-for="project in list" :key="project.id" v-if="project.name">
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… ä½¿ç”¨ `<template>` æ ‡ç­¾åˆ†ç¦» `v-for` å’Œ `v-if`
- âœ… éµå¾ªVue 3æœ€ä½³å®è·µï¼Œæ¡ä»¶æ¸²æŸ“æ”¾åœ¨å†…éƒ¨å…ƒç´ 
```vue
<!-- âœ… æ­£ç¡®åšæ³• -->
<template v-for="project in list" :key="project.id">
  <div v-if="project.name">
</template>
```

### ğŸ“‹ å¼€å‘æ£€æŸ¥æ¸…å•

#### å‰ç«¯å¼€å‘å‰å¿…åšæ£€æŸ¥ï¼š
- [ ] æŸ¥çœ‹åç«¯å®é™…ä»£ç ï¼Œç¡®è®¤APIæ¥å£æ ¼å¼
- [ ] éªŒè¯åç«¯è¿”å›çš„æ•°æ®ç»“æ„
- [ ] **é‡è¦**ï¼šä»”ç»†æŸ¥çœ‹APIå°è£…å±‚çš„å®é™…è¿”å›å€¼ï¼ˆä¸è¦å‡è®¾ï¼‰
- [ ] ç¡®è®¤ç¬¬ä¸‰æ–¹åº“çš„APIå’Œå¯ç”¨èµ„æº
- [ ] æµ‹è¯•æŠ€æœ¯æ ˆé›†æˆçš„åˆå§‹åŒ–é¡ºåº
- [ ] éªŒè¯Vueæ¨¡æ¿è¯­æ³•çš„æœ€ä½³å®è·µï¼ˆv-for/v-ifåˆ†ç¦»ï¼‰

#### æ¯ä¸ªåŠŸèƒ½å®Œæˆåæ£€æŸ¥ï¼š
- [ ] åŠŸèƒ½åœ¨æµè§ˆå™¨ä¸­æ­£å¸¸å·¥ä½œ
- [ ] åˆ·æ–°é¡µé¢åçŠ¶æ€æ­£ç¡®æ¢å¤
- [ ] å›½é™…åŒ–åˆ‡æ¢æ­£å¸¸
- [ ] ä¸»é¢˜åˆ‡æ¢æ­£å¸¸
- [ ] å“åº”å¼å¸ƒå±€é€‚é…è‰¯å¥½
- [ ] æ— æ§åˆ¶å°é”™è¯¯

### ğŸ› ï¸ æŠ€æœ¯æ¶æ„æ”¹è¿›

#### 1. æ•°æ®è½¬æ¢å±‚
åœ¨å„ä¸ªstoreä¸­æ·»åŠ æ˜ç¡®çš„æ•°æ®è½¬æ¢é€»è¾‘ï¼š
```javascript
// å¤„ç†åç«¯è¿”å›çš„æ•°æ®ç»“æ„
if (response.success && response.projects) {
  this.projectList = response.projects.map(project => ({
    name: project.project_name,      // å­—æ®µåè½¬æ¢
    created_at: project.created_at,
    updated_at: project.updated_at,
    file_path: project.file_path
  }))
}
```

#### 2. å›½é™…åŒ–é…ç½®ç‹¬ç«‹
```javascript
// /src/locales/index.js - ç‹¬ç«‹çš„å›½é™…åŒ–é…ç½®
export const messages = { ... }

// /src/main.js - ç®€æ´çš„ä¸»å…¥å£
import { messages } from './locales'
```

#### 3. é”™è¯¯å¤„ç†æ”¹è¿›
```javascript
// å¤„ç†åç«¯APIçš„é”™è¯¯å“åº”æ ¼å¼
if (response.data && response.data.error) {
  throw new Error(response.data.error)
}
```

#### 4. APIå°è£…å±‚ç†è§£çº æ­£
```javascript
// âŒ é”™è¯¯ç†è§£ï¼šè®¤ä¸ºapiServiceè¿”å›å®Œæ•´responseå¯¹è±¡
if (response.data.success && response.data.projects)

// âœ… æ­£ç¡®ç†è§£ï¼šapiServiceå·²ç»è¿”å›response.data
if (response.success && response.projects)
```

#### 5. Vue 3æ¨¡æ¿è¯­æ³•æœ€ä½³å®è·µ
```vue
<!-- âŒ é”™è¯¯ï¼šv-forå’Œv-ifåœ¨åŒä¸€å…ƒç´ ä¸Š -->
<div v-for="item in list" :key="item.id" v-if="item.visible">

<!-- âœ… æ­£ç¡®ï¼šä½¿ç”¨templateåˆ†ç¦» -->
<template v-for="item in list" :key="item.id">
  <div v-if="item.visible">
</template>
```

## æ€»ç»“

æœ¬è®¾è®¡æ–‡æ¡£è¯¦ç»†è§„åˆ’äº† ResVizCopilot 2.0 å‰ç«¯çš„æ•´ä½“æ¶æ„ã€æŠ€æœ¯é€‰å‹ã€åŠŸèƒ½æ¨¡å—ã€äº¤äº’æµç¨‹å’Œå®ç°ç»†èŠ‚ã€‚åˆ†ä¸ºå½“å‰é˜¶æ®µå’Œåç»­ç‰ˆæœ¬ä¸¤ä¸ªå®æ–½è®¡åˆ’ã€‚

é€šè¿‡ç¬¬ä¸€é˜¶æ®µçš„å¼€å‘å®è·µï¼Œæˆ‘ä»¬æ€»ç»“äº†é‡è¦çš„ç»éªŒæ•™è®­ï¼Œå»ºç«‹äº†å¼€å‘æ£€æŸ¥æ¸…å•ï¼Œæ”¹è¿›äº†æŠ€æœ¯æ¶æ„è®¾è®¡ã€‚è¿™äº›ç»éªŒå°†æŒ‡å¯¼åç»­å¼€å‘ï¼Œå‡å°‘ç±»ä¼¼é—®é¢˜çš„å‘ç”Ÿã€‚

### å½“å‰é˜¶æ®µåŠŸèƒ½èŒƒå›´

**âœ… å½“å‰é˜¶æ®µå®ç°ï¼š**
1. **å·¥ç¨‹å­˜æ¡£ç®¡ç†**ï¼šå®Œæ•´çš„é¡¹ç›®åˆ›å»ºã€ä¿å­˜ã€åŠ è½½ã€åˆ é™¤åŠŸèƒ½
2. **ç ”ç©¶æ ‘å¯è§†åŒ–**ï¼šåŸºäº Mind-elixir çš„åªè¯»æ€ç»´å¯¼å›¾æ¸²æŸ“å’Œå±•ç¤º
3. **æ•°æ®è½¬æ¢ç³»ç»Ÿ**ï¼šåç«¯ç ”ç©¶æ ‘æ•°æ®åˆ° Mind-elixir æ ¼å¼çš„æ— ç¼è½¬æ¢
4. **èŠ‚ç‚¹æ ·å¼åŒºåˆ†**ï¼šä½¿ç”¨åŸç”Ÿå±æ€§ï¼ˆstyleã€tagsã€iconsï¼‰å®ç°ç±»å‹å’ŒçŠ¶æ€åŒºåˆ†
5. **å¿«ç…§æŸ¥çœ‹åŠŸèƒ½**ï¼šä¸´æ—¶æŸ¥çœ‹å†å²å¿«ç…§çŠ¶æ€ï¼Œæ”¯æŒä¸»é¢˜åˆ‡æ¢
6. **æ¶ˆæ¯åˆ—è¡¨å’ŒAIå¯¹è¯**ï¼šå®Œæ•´çš„æ™ºèƒ½ä½“äº¤äº’åŠŸèƒ½
7. **å®æ—¶æ•°æ®æµ**ï¼šåŸºäº SSE çš„æµå¼æ•°æ®å¤„ç†

**ğŸš§ åç»­ç‰ˆæœ¬åŠŸèƒ½ï¼š**
1. **ç ”ç©¶æ ‘äº¤äº’ç¼–è¾‘**ï¼šèŠ‚ç‚¹çš„åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤æ“ä½œ
2. **çº¦æŸéªŒè¯ç³»ç»Ÿ**ï¼šç¼–è¾‘æƒé™å’Œä¸šåŠ¡è§„åˆ™æ£€æŸ¥
3. **æ‹–æ‹½æ“ä½œ**ï¼šèŠ‚ç‚¹ä½ç½®è°ƒæ•´å’Œå±‚çº§å˜æ›´
4. **å³é”®èœå•**ï¼šä¸°å¯Œçš„èŠ‚ç‚¹æ“ä½œèœå•
5. **ååŒç¼–è¾‘**ï¼šå¤šç”¨æˆ·å®æ—¶ç¼–è¾‘åŠŸèƒ½

### æŠ€æœ¯äº®ç‚¹
1. **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**ï¼šVue 3 + Options API é£æ ¼ï¼Œæä¾›ä¼˜ç§€çš„å¼€å‘ä½“éªŒ
2. **ç®€æ´æ¶æ„è®¾è®¡**ï¼šåŸºäº Mind-elixir åŸç”ŸåŠŸèƒ½ï¼Œé¿å…é‡å¤é€ è½®å­
3. **é«˜æ•ˆæ•°æ®è½¬æ¢**ï¼šæ™ºèƒ½çš„åç«¯æ•°æ®åˆ°æ€ç»´å¯¼å›¾æ•°æ®è½¬æ¢ï¼Œä¿æŒæ•°æ®å®Œæ•´æ€§
4. **åŸç”Ÿæ ·å¼ç³»ç»Ÿ**ï¼šå……åˆ†åˆ©ç”¨ Mind-elixir çš„ styleã€tagsã€icons å±æ€§å®ç°ä¸°å¯Œè§†è§‰æ•ˆæœ
5. **åªè¯»æ¨¡å¼ä¼˜åŒ–**ï¼šé€šè¿‡é…ç½®å®Œå…¨ç¦ç”¨ç¼–è¾‘åŠŸèƒ½ï¼Œç¡®ä¿æ•°æ®å®‰å…¨
6. **å“åº”å¼è®¾è®¡**ï¼šæ”¯æŒå¤šç«¯é€‚é…ï¼Œæä¾›ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒ
7. **å®æ—¶äº¤äº’**ï¼šåŸºäº SSE çš„æµå¼æ•°æ®å¤„ç†ï¼Œå®ç°æ™ºèƒ½ä½“å®æ—¶å¯¹è¯
8. **å¯è§†åŒ–åˆ›æ–°**ï¼šåŸºäºæˆç†Ÿçš„ Mind-elixir åº“ï¼Œç›´è§‚å±•ç¤ºå¤æ‚çš„é—®é¢˜-è§£å†³æ–¹æ¡ˆå…³ç³»

### è®¾è®¡åŸåˆ™
1. **ç”¨æˆ·ä½“éªŒä¼˜å…ˆ**ï¼šç•Œé¢ç®€æ´ç›´è§‚ï¼Œæ“ä½œæµç¨‹é¡ºç•…
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šè™šæ‹Ÿæ»šåŠ¨ã€æ‡’åŠ è½½ã€ç¼“å­˜ç­–ç•¥ç­‰å¤šé‡ä¼˜åŒ–
3. **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆæœºåˆ¶
4. **å¯ç»´æŠ¤æ€§**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ¸…æ™°ç»“æ„ï¼Œå®Œå–„çš„æµ‹è¯•è¦†ç›–
5. **å¯æ‰©å±•æ€§**ï¼šæ’ä»¶åŒ–æ¶æ„ï¼Œæ”¯æŒåŠŸèƒ½æ‰©å±•å’Œå®šåˆ¶

### åˆ›æ–°ç‰¹æ€§
1. **æ™ºèƒ½ä½“åä½œ**ï¼šæ”¯æŒå¤šæ™ºèƒ½ä½“ååŒå·¥ä½œï¼Œå®ç°å¤æ‚çš„ç ”ç©¶æµç¨‹è‡ªåŠ¨åŒ–
2. **çº¦æŸé©±åŠ¨**ï¼šåŸºäºä¸šåŠ¡è§„åˆ™çš„äº¤äº’çº¦æŸï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
3. **å¿«ç…§æœºåˆ¶**ï¼šå®Œæ•´çš„å†å²ç‰ˆæœ¬ç®¡ç†ï¼Œæ”¯æŒä»»æ„æ—¶ç‚¹çš„çŠ¶æ€å›æº¯
4. **æµå¼äº¤äº’**ï¼šå®æ—¶çš„æ™ºèƒ½ä½“å¯¹è¯ä½“éªŒï¼Œæ”¯æŒä¸­æ–­å’Œæ¢å¤
5. **æ•°æ®è½¬æ¢**ï¼šåç«¯æ•°æ®ä¸å‰ç«¯å¯è§†åŒ–çš„æ— ç¼è½¬æ¢

è¯¥è®¾è®¡æ–¹æ¡ˆå……åˆ†è€ƒè™‘äº†é¡¹ç›®çš„å¤æ‚æ€§å’Œæ‰©å±•æ€§éœ€æ±‚ï¼Œä¸ºåç»­çš„å¼€å‘å®æ–½æä¾›äº†æ¸…æ™°çš„æŒ‡å¯¼å’Œè§„èŒƒã€‚é€šè¿‡åˆç†çš„æ¶æ„è®¾è®¡å’ŒæŠ€æœ¯é€‰å‹ï¼Œèƒ½å¤Ÿç¡®ä¿é¡¹ç›®çš„é«˜è´¨é‡äº¤ä»˜å’Œé•¿æœŸå¯ç»´æŠ¤æ€§ã€‚
