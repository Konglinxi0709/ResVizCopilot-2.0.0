# ResVizCopilot 2.0 前端开发进度

## 项目概述
基于Vue 3 + Element Plus + Mind-elixir的科研智能体前端界面，实现研究树可视化、智能体对话和工程管理三大核心功能。

## 开发阶段规划

### 阶段一：基础框架搭建与技术验证 ✅
> **目标**：验证技术可行性，搭建基础开发环境，实现最小可用原型
> **预期效果**：能够运行基础Vue应用，验证Mind-elixir集成可行性
> **状态**：已完成 - Vue 3应用已成功运行在 http://localhost:8080

- [x] **1.1 项目初始化与环境配置**
  - [x] 清理现有src目录，重新初始化Vue 3项目结构

  - [x] 安装并配置核心依赖：Vue 3、Pinia、Element Plus、Mind-elixir

  - [x] 配置开发环境的API代理，连接后端服务

- [ ] **1.2 Mind-elixir技术验证**
  - [ ] 创建简单的Mind-elixir包装组件
  - [ ] 验证Mind-elixir的基础渲染功能
  - [ ] 测试只读模式配置，确保禁用所有编辑功能
  - [ ] 验证节点样式自定义能力（style、tags、icons属性）
  - [ ] 测试数据格式转换的可行性

- [x] **1.3 基础UI框架**
  - [x] 创建应用根组件App.vue，实现三栏布局结构
  - [x] 创建基础的头部导航组件
  - [x] 实现响应式布局框架（桌面/平板/移动端适配）
  - [x] 配置Element Plus主题和全局样式
  - [x] 创建基础的加载和错误提示组件
  - [x] 创建Pinia状态管理stores (projectStore, treeStore, messageStore, uiStore)
  - [x] 创建API服务层 (apiService.js)
  - [x] 创建基础组件框架 (AppHeader, ProjectManager, ResearchTree, MessageCenter)

### 阶段二：数据转换与研究树可视化 🌳
> **目标**：实现后端数据到Mind-elixir的转换，完成研究树的基础展示
> **预期效果**：能够正确显示后端研究树数据，节点样式区分清晰

- [ ] **2.1 数据转换服务**
  - [ ] 实现ResearchTreeTransformer类，处理后端快照数据转换
  - [ ] 实现节点样式配置系统（问题节点、解决方案节点的颜色区分）
  - [ ] 实现状态指示器（进行中、成功、失败、选中等状态的图标显示）
  - [ ] 处理特殊标识（智能体操作中、快照查看等临时状态）
  - [ ] 创建空数据和错误数据的处理逻辑

- [ ] **2.2 研究树组件开发**
  - [ ] 创建MindElixirWrapper组件，封装Mind-elixir实例
  - [ ] 实现只读模式的Mind-elixir配置
  - [ ] 实现节点选择事件处理
  - [ ] 创建NodeInfoPanel组件，显示选中节点的详细信息
  - [ ] 实现快照查看的临时显示功能

- [ ] **2.3 API集成测试**
  - [ ] 创建API服务层，封装后端接口调用
  - [ ] 实现获取当前快照数据的接口调用
  - [ ] 实现获取指定快照数据的接口调用
  - [ ] 测试数据转换的完整流程
  - [ ] 验证不同类型节点的正确显示

### 阶段三：状态管理与工程管理 📁
> **目标**：实现Pinia状态管理，完成工程的创建、保存、加载功能
> **预期效果**：能够管理多个工程，支持工程切换和数据持久化

- [ ] **3.1 Pinia状态管理**
  - [ ] 创建projectStore，管理当前工程和工程列表
  - [ ] 创建treeStore，管理研究树数据和选中状态
  - [ ] 创建uiStore，管理界面状态和主题设置
  - [ ] 实现状态持久化（localStorage）
  - [ ] 创建状态锁管理器，处理操作互斥

- [ ] **3.2 工程管理组件**
  - [ ] 创建ProjectManager主组件
  - [ ] 创建ProjectHeader组件，显示当前工程信息和操作按钮
  - [ ] 创建ProjectList组件，显示工程列表和搜索功能
  - [ ] 创建ProjectDialog组件，处理工程创建和另存为
  - [ ] 实现工程的创建、保存、加载、删除功能

- [ ] **3.3 工程管理API集成**
  - [ ] 实现工程管理相关的API调用
  - [ ] 处理工程操作的错误和加载状态
  - [ ] 实现工程切换时的数据同步
  - [ ] 添加操作确认对话框和用户反馈

### 阶段四：消息系统与智能体对话 💬
> **目标**：实现消息列表展示和智能体交互功能
> **预期效果**：能够显示消息历史，支持智能体选择和消息发送

- [ ] **4.1 消息展示组件**
  - [ ] 创建MessageCenter主组件
  - [ ] 创建MessageList组件，支持虚拟滚动优化
  - [ ] 创建MessageItem组件，支持三层结构（标题→内容→思考）
  - [ ] 创建MarkdownRenderer组件，渲染消息内容
  - [ ] 实现消息的折叠展开功能

- [ ] **4.2 智能体交互组件**
  - [ ] 创建AgentSelector组件，智能体选择下拉框
  - [ ] 创建NodeSelector组件，根据智能体类型动态显示可选节点
  - [ ] 创建ChatInput组件，多行文本输入和发送功能
  - [ ] 实现智能体配置和节点过滤逻辑
  - [ ] 添加输入验证和错误提示

- [ ] **4.3 消息状态管理**
  - [ ] 创建messageStore，管理消息列表和状态
  - [ ] 实现消息的增删改查操作
  - [ ] 处理消息的生成状态（generating、completed、failed）
  - [ ] 实现消息操作（查看快照、回溯消息、复制内容）

### 阶段五：SSE流式数据与实时交互 ⚡
> **目标**：实现SSE流式数据接收，支持实时消息更新和智能体交互
> **预期效果**：智能体对话流畅，支持实时数据流和断连重连

- [ ] **5.1 SSE服务开发**
  - [ ] 创建SSEService类，管理EventSource连接
  - [ ] 实现自动重连机制和错误处理
  - [ ] 实现patch数据的解析和应用
  - [ ] 处理连接状态的UI反馈
  - [ ] 实现连接断开时的优雅降级

- [ ] **5.2 流式数据处理**
  - [ ] 实现消息的实时更新机制
  - [ ] 处理思考过程的流式显示
  - [ ] 实现智能体操作状态的实时反馈
  - [ ] 处理数据库操作结果的同步
  - [ ] 实现停止生成功能

- [ ] **5.3 智能体调用集成**
  - [ ] 集成智能体消息发送API
  - [ ] 实现智能体工作状态的界面锁定
  - [ ] 处理智能体错误和超时情况
  - [ ] 实现消息回溯功能
  - [ ] 添加操作进度指示和用户反馈

### 阶段六：快照功能与历史查看 📸
> **目标**：实现快照的临时查看功能，支持历史状态回溯
> **预期效果**：能够查看任意历史快照，支持快照间的切换和对比

- [ ] **6.1 快照查看功能**
  - [ ] 实现快照的临时显示机制
  - [ ] 创建快照查看的UI提示和控制
  - [ ] 实现快照主题的切换（降低透明度等视觉效果）
  - [ ] 处理快照查看状态的进入和退出
  - [ ] 实现快照数据的缓存机制

- [ ] **6.2 快照控制组件**
  - [ ] 创建SnapshotControls组件
  - [ ] 实现快照查看的触发按钮
  - [ ] 添加"正在查看历史快照"的状态提示
  - [ ] 实现返回当前状态的功能
  - [ ] 处理快照查看时的操作限制

### 阶段七：用户体验优化与完善 ✨
> **目标**：优化用户体验，完善错误处理，提升应用的稳定性和易用性
> **预期效果**：应用运行稳定，用户操作流畅，错误处理完善

- [ ] **7.1 性能优化**
  - [ ] 实现组件懒加载和代码分割
  - [ ] 优化大数据量的渲染性能
  - [ ] 实现防抖和节流优化
  - [ ] 添加缓存策略减少API调用
  - [ ] 优化Mind-elixir的渲染性能

- [ ] **7.2 错误处理与用户反馈**
  - [ ] 完善全局错误处理机制
  - [ ] 实现友好的错误提示和恢复建议
  - [ ] 添加操作确认对话框
  - [ ] 实现加载状态和进度指示
  - [ ] 添加操作成功的反馈提示

- [ ] **7.3 国际化与主题**
  - [ ] 配置Vue I18n国际化支持
  - [ ] 实现中英文语言切换
  - [ ] 完善暗色主题支持
  - [ ] 实现主题的动态切换
  - [ ] 优化不同主题下的视觉效果

### 阶段八：测试与部署准备 🚀
> **目标**：完善测试覆盖，准备生产部署，确保应用质量
> **预期效果**：应用通过完整测试，具备生产部署条件

- [ ] **8.1 测试完善**
  - [ ] 编写核心组件的单元测试
  - [ ] 编写API集成测试
  - [ ] 编写用户交互的E2E测试
  - [ ] 测试不同浏览器的兼容性
  - [ ] 测试响应式布局的适配效果


## 开发原则

### 技术原则
- **渐进式开发**：每个阶段都有可运行的成果，便于测试和验证
- **组件化设计**：高内聚低耦合，便于维护和扩展
- **性能优先**：关注用户体验，优化加载和渲染性能
- **错误优雅**：完善的错误处理和用户反馈机制

### 质量原则
- **代码质量**：清晰的代码结构和注释说明
- **测试驱动**：重要功能必须有测试覆盖
- **文档完善**：清晰的API文档和使用说明
- **版本控制**：合理的Git提交和分支管理

## 当前状态
- ✅ **阶段一完成**：基础框架搭建与技术验证已完成
- 🎯 **当前运行状态**：Vue 3应用已成功运行在 http://localhost:8080
- 📋 **已实现功能**：
  - 三栏响应式布局（工程管理、研究树可视化、消息对话）
  - 完整的状态管理系统（Pinia stores）
  - API服务层（支持后端代理）
  - 基础UI组件框架
  - 国际化支持（中英文切换）
  - 主题切换（亮色/暗色）
- 🎯 **下一步**：开始阶段二的Mind-elixir集成和数据转换

## Cursor要求
- 开发过程中发现任何问题，例如原始设计有缺陷、遇到不能判断的选择、遇到难以解决的困难等，必须停下来向用户询问，甚至是多次对话询问，直到得到用户准确的答复之后再继续。
- 开发过程中完成规定任务后，必须更新本文档，勾掉已经完成的部分
- 如果在开发过程中修改了原始设计，必须向用户询问说明，得到肯定答复后必须更新前端总体需求和架构设计.md文档以及本文档，使设计时刻与具体实施保持一致。
- 前端已经启动，保持无头模式运行，日志记录在frontend/vue.log。
- 对于mind-elixir，其所有的功能说明必须严格参考文档`frontend/mind-elixir介绍文档.md`和官方插件项目`tests/node-menu（mind-elixir的插件，用于参考）`，必要时也可以参考我的老项目中的相关组件`tests/frontend（老）/src/App/MindTree.vue`。你必须仔细阅读这些信息，遇到问题时也必须反复查看这些信息，纠正自己的错误认识。
---
